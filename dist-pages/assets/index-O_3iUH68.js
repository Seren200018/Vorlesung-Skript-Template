(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function o(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(t){if(t.ep)return;t.ep=!0;const s=o(t);fetch(t.href,s)}})();const at=["yellow","mint","blue","pink","gray"];function it(r={}){const e=document.body,o={...window.TemplateSettings||{},...r.settings||{}},n={...window.SymbolSettings||{},...r.symbolSettings||{}},t=Array.from(document.querySelectorAll(".sheet"));return t.forEach((s,a)=>{s.dataset.pageNumber=a+1,s.id||(s.id=`sheet-${a+1}`)}),{body:e,sheets:t,userSettings:o,symbolSettings:n,lectureTitle:e.dataset.lectureTitle||o.lectureTitle||"Vorlagenkurs",lectureChapter:e.dataset.lectureChapter||o.lectureChapter||"Kapitel",highlightColors:r.highlightColors||at,audioDefaults:o.audio||{mode:"manual"},markerMap:new Map,videoEntries:[],sheetAudio:[],audioRegistry:[],notesStorageKey:r.notesStorageKey||"sheetNotesStateV1"}}function W(r,e){try{e()}catch(o){console.warn(`${r} failed`,o)}}function ct(r){let e=!1,o=null;function n(){if(e||window.MathJax&&typeof MathJax.typesetPromise=="function")return e=!0,Promise.resolve();if(o)return o;window.MathJax=window.MathJax||{},window.MathJax.tex=window.MathJax.tex||{tags:"ams"};const s=[r.body.dataset.mathjaxSrc,...Array.isArray(r.userSettings.mathJaxSources)?r.userSettings.mathJaxSources:[],"node_modules/mathjax/es5/tex-mml-chtml.js","https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"].filter(Boolean);return o=new Promise((a,i)=>{const u=c=>{if(c>=s.length){i(new Error("MathJax load failed"));return}const l=document.createElement("script");l.id="mathjax-script",l.async=!0,l.src=s[c],l.onload=()=>{e=!0,a()},l.onerror=()=>u(c+1),document.head.appendChild(l)};u(0)}),o}function t(s){n().then(()=>{window.MathJax&&typeof MathJax.typesetPromise=="function"&&MathJax.typesetPromise(s).catch(()=>{})})}return{ensureMathJax:n,typeset:t}}function lt(r){let e=!1,o=null;function n(){if(e||window.JSZip&&typeof window.JSZip=="function")return e=!0,Promise.resolve();if(o)return o;const t=[r.body.dataset.jszipSrc,...Array.isArray(r.userSettings.jsZipSources)?r.userSettings.jsZipSources:[],"node_modules/jszip/dist/jszip.min.js","https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"].filter(Boolean);return o=new Promise((s,a)=>{const i=u=>{if(u>=t.length){a(new Error("JSZip load failed"));return}const c=document.createElement("script");c.src=t[u],c.async=!0,c.onload=()=>{e=!0,s()},c.onerror=()=>i(u+1),document.head.appendChild(c)};i(0)}),o}return{ensureJSZip:n}}function ut({typeset:r,requestAudioUpdate:e}){let o,n,t,s=!1;const a=()=>s?!0:(o=document.getElementById("subsheet-panel"),n=document.getElementById("subsheet-content"),t=document.getElementById("subsheet-close"),!o||!n||!t?!1:(t.addEventListener("click",()=>{document.body.classList.remove("panel-open"),n.innerHTML="",e()}),s=!0,!0));document.addEventListener("click",i=>{var p,h;const u=(h=(p=i.target).closest)==null?void 0:h.call(p,".sub-page-wrapper");if(!u||!a())return;i.stopPropagation();const c=u.closest(".sheet");if(!c)return;const l=c.querySelectorAll(".sub-page-sheet");n.innerHTML="",l.forEach(d=>n.appendChild(d.cloneNode(!0))),document.body.classList.add("panel-open"),o.scrollTop=0,r([n]),e()})}function dt({sheets:r}){r.forEach(e=>{const o=Number(e.dataset.pageNumber);Array.from(e.querySelectorAll(".sub-page-sheet")).forEach((t,s)=>{t.dataset.subpageId=`${o}-${s+1}`})})}function ht(r){const{sheets:e,markerMap:o,lectureChapter:n,lectureTitle:t}=r,s=document.getElementById("toc-list");if(!s)return;const a=new Map;e.forEach(c=>{const l=Number(c.dataset.pageNumber);c.querySelectorAll("[data-toc]").forEach(p=>{const h=(p.dataset.toc||"").trim();if(!h)return;const d=h;o.has(d)||o.set(d,[]),o.get(d).push(p);const f=a.get(d);(!f||l<f.page)&&a.set(d,{page:l,sheet:c})})}),s.innerHTML="";const i=Array.from(a.entries()).sort((c,l)=>{const p=c[1].page-l[1].page;return p!==0?p:c[0].localeCompare(l[0])});if(i.forEach(([c,l],p)=>{var v;l.number=p+1;const h=document.createElement("li");h.className="toc-item",h.dataset.target=((v=l.sheet)==null?void 0:v.id)||"",h.setAttribute("role","button"),h.tabIndex=0;const d=document.createElement("span");d.className="toc-number",d.textContent=`${l.number}.`;const f=document.createElement("span");f.className="toc-title";const g=`${l.number}. ${c}`;f.textContent=c;const w=document.createElement("span");w.className="toc-page",w.textContent=l.page,h.append(d,f,w),s.appendChild(h);const S=o.get(c)||[];S.length&&(S[0].textContent=g)}),!s.children.length){const c=document.createElement("li");c.textContent="(keine Eintr√§ge markiert)",s.appendChild(c)}s.addEventListener("click",c=>{const l=c.target.closest(".toc-item[data-target]");if(!l)return;const p=l.dataset.target;if(!p)return;const h=document.getElementById(p);h&&(h.scrollIntoView({behavior:"smooth",block:"start"}),document.body.classList.remove("panel-open"))});const u=c=>{let l=null;return i.forEach(([p,h])=>{h.page<=c&&(l={title:p,number:h.number})}),l};e.forEach(c=>{if(c.classList.contains("Titlepage"))return;const l=Number(c.dataset.pageNumber),p=u(l);if(!p)return;const h=pt(c);let d=c.querySelector(".page-header");d||(d=document.createElement("div"),d.className="page-header",c.appendChild(d)),d.innerHTML=`<span>${n}</span><span>${p.number}. ${p.title}</span>`;let f=c.querySelector(".page-footer");f||(f=document.createElement("div"),f.className="page-footer",c.appendChild(f)),f.innerHTML=`<span class="page-footer__title">${t}</span>`,c.appendChild(ft(h,l)),c.querySelectorAll(".sub-page-sheet").forEach((g,w)=>{let S=g.querySelector(".page-header");S||(S=document.createElement("div"),S.className="page-header",g.appendChild(S)),S.innerHTML=`<span>${n}</span><span>${p.number}. ${p.title} ‚Äì ${w+1}</span>`;let v=g.querySelector(".page-footer");v||(v=document.createElement("div"),v.className="page-footer",g.appendChild(v)),v.innerHTML=`<span class="page-footer__title">${t}</span>`})})}function $e(r){return(r||"").toString().trim().toLowerCase().replace(/['"()]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"")}function pt(r){var t,s;if(r.dataset.linkSlug)return r.dataset.linkSlug;const e=r.dataset.link||"",o=((s=(t=r.querySelector("[data-toc]"))==null?void 0:t.dataset)==null?void 0:s.toc)||"";let n=$e(e)||$e(o)||$e(r.id)||`sheet-${r.dataset.pageNumber||""}`;if(n||(n=`sheet-${Date.now()}`),r.dataset.linkSlug=n,!document.getElementById(n)){const a=document.createElement("a");a.id=n,a.className="sheet-link-anchor",a.setAttribute("aria-hidden","true"),r.prepend(a)}return n}function ft(r,e){const o=document.createElement("a");return o.className="page-number-link",o.href=`#${r}`,o.textContent=e?`${e}`:r,o.title=`Link zu Seite ${e||r} kopieren`,o.addEventListener("click",n=>{var s;n.preventDefault();const t=new URL(window.location.href);t.hash=r,(s=navigator.clipboard)==null||s.writeText(t.toString()).catch(()=>{})}),o}function mt(r,e){const{sheets:o,symbolSettings:n}=r,t=[],s=c=>{var d;const l=c.id;if(l&&n.byId&&n.byId[l])return n.byId[l];const p=c.querySelector("[data-toc]"),h=(d=p==null?void 0:p.dataset.toc)==null?void 0:d.trim();return h&&n.byTitle&&n.byTitle[h]?n.byTitle[h]:n.defaultSymbols||""},a=c=>c.split(";").map(l=>{const[p,...h]=l.split(":"),d=(p||"").trim(),f=h.join(":").trim();return d?{symbol:d,desc:f}:null}).filter(Boolean),i=c=>{const l=n.globalDefinitions||{},p=c.map(({symbol:h})=>{const d=l[h];return d?{symbol:h,desc:d}:null}).filter(Boolean);return p.length?p:c},u=c=>{const l=[],p=c.innerText||"",h=g=>{let w;for(;(w=g.exec(p))!==null;)l.push(w[1])};h(/\\begin\{equation\}([\s\S]*?)\\end\{equation\}/g),h(/\\\(([\\s\\S]*?)\\\)/g),h(/\\\[([\\s\\S]*?)\\\]/g);const d=new Set(["begin","end","frac","sqrt","left","right","cdot","ddot","dot","mathrm","mathit","text","sin","cos","tan","exp","log"]),f=[];return l.forEach(g=>{(g.match(/\\?[A-Za-z][A-Za-z0-9]*/g)||[]).forEach(w=>{const S=w.replace(/^\\/,"");!S||d.has(S)||f.includes(S)||f.push(S)})}),f.map(g=>({symbol:g,desc:""}))};o.forEach(c=>{if(c.classList.contains("Titlepage"))return;const l=c.dataset.symbols||"",p=s(c),h=l.trim()?a(l):p.trim()?a(p):i(u(c)),d=i(h);if(!d.length)return;c.classList.add("has-symbols");let f=c.querySelector(".symbol-column");f||(f=document.createElement("div"),f.className="symbol-column",c.appendChild(f)),f.innerHTML="";const g=document.createElement("div");g.className="symbol-column-title",g.textContent="Symbole",f.appendChild(g),d.forEach(({symbol:w,desc:S})=>{const v=document.createElement("div");v.className="symbol-row";const A=document.createElement("span");A.className="symbol",A.innerHTML=`\\(${w}\\)`;const O=document.createElement("span");O.className="desc",O.textContent=S||"",v.append(A,O),f.appendChild(v)}),t.push(f)}),t.length&&e&&e(t)}function gt({sheets:r}){const e=document.getElementById("fig-list"),o=document.getElementById("table-list");if(!e&&!o)return;const n={figure:[],table:[]};r.forEach(a=>{const i=Number(a.dataset.pageNumber);a.querySelectorAll("[data-figure]").forEach((u,c)=>{const l=(u.dataset.figure||u.getAttribute("data-figure")||"").trim();l&&n.figure.push({title:l,page:i,sheet:a,idx:c,node:u})}),a.querySelectorAll("[data-table]").forEach((u,c)=>{const l=(u.dataset.table||u.getAttribute("data-table")||"").trim();l&&n.table.push({title:l,page:i,sheet:a,idx:c,node:u})})});const t=(a,i,u)=>{if(a){if(a.innerHTML="",!i.length){const c=document.createElement("li");c.textContent="(keine Eintr√§ge markiert)",a.appendChild(c);return}i.sort((c,l)=>{const p=c.page-l.page;return p!==0?p:c.title.localeCompare(l.title)}),i.forEach((c,l)=>{var g;c.number=l+1;const p=document.createElement("li");p.className="toc-item",p.dataset.target=((g=c.sheet)==null?void 0:g.id)||"",p.setAttribute("role","button"),p.tabIndex=0;const h=document.createElement("span");h.className="toc-number",h.textContent=`${c.number}.`;const d=document.createElement("span");d.className="toc-title",d.textContent=c.title;const f=document.createElement("span");f.className="toc-page",f.textContent=c.page,p.append(h,d,f),a.appendChild(p)}),u==="figure"&&i.forEach(c=>{var d,f;const l=(d=c.node)==null?void 0:d.querySelector("figcaption");if(!l)return;const p=((f=l.querySelector("small"))==null?void 0:f.outerHTML)||"",h=`<strong>Abb. ${c.number}</strong>: ${c.title}`;l.innerHTML=p?`${h} ${p}`:h}),u==="table"&&i.forEach(c=>{var h;const l=(h=c.node)==null?void 0:h.closest("div.image-caption");if(!l)return;const p=`<strong>Tabelle ${c.number}</strong>: ${c.title}`;l.innerHTML=p})}};t(e,n.figure,"figure"),t(o,n.table,"table");const s=a=>{const i=a.target.closest(".toc-item[data-target]");if(!i)return;const u=i.dataset.target;if(!u)return;const c=document.getElementById(u);c&&(c.scrollIntoView({behavior:"smooth",block:"start"}),document.body.classList.remove("panel-open"))};e&&e.addEventListener("click",s),o&&o.addEventListener("click",s)}function bt(r,{ensureJSZip:e}){const{sheets:o,highlightColors:n,notesStorageKey:t}=r;let s=h(t),a=null,i=null,u=null,c=null,l=null,p=!1;s.docId=s.docId||ne(),s.sheetMeta=Array.isArray(s.sheetMeta)?s.sheetMeta:[];function h(y){try{const m=localStorage.getItem(y);if(!m)return{notes:{},highlights:{}};const x=JSON.parse(m);return{notes:x.notes||{},highlights:x.highlights||{},docId:x.docId,sheetMeta:x.sheetMeta||[]}}catch(m){return console.warn("Notes load failed",m),{notes:{},highlights:{}}}}function d(){try{s.docId||(s.docId=ne()),Array.isArray(s.sheetMeta)||(s.sheetMeta=[]),localStorage.setItem(t,JSON.stringify(s))}catch(y){console.warn("Notes save failed",y)}}function f(){s.notes=s.notes||{},s.highlights=s.highlights||{},s.sheetMeta=ae(),d(),o.forEach((y,m)=>{if(y.classList.contains("Titlepage"))return;const x=y.id||`sheet-${m+1}`,C=s.notes[x]||"";let I=y.querySelector(".sheet-notes");I||(I=document.createElement("div"),I.className="sheet-notes",I.innerHTML=`
          <div class="sheet-notes__title"></div>
          <textarea class="sheet-notes__area" aria-label="Notizen"></textarea>
          <div class="sheet-notes__highlights"></div>
        `,y.appendChild(I));const $=I.querySelector(".sheet-notes__title");$&&($.textContent=`Notizen zu Seite ${y.dataset.pageNumber||m+1}`);const j=I.querySelector(".sheet-notes__area");j&&(j.value=C,j.addEventListener("input",()=>{s.notes[x]=j.value,d()})),S(y,x)}),de()}function g(y,m){s.highlights[m]=[],y.querySelectorAll(".highlight-note").forEach(x=>O(x)),d()}function w(y,m,x,C,I){const $=(x.toString()||"").trim();if(!$)return;const j={id:`${Date.now()}-${Math.random().toString(16).slice(2,8)}`,text:$,comment:C||"",color:n.includes(I)?I:"yellow"};if(!v(y,j,x))return;const z=s.highlights[m]||[];z.push(j),s.highlights[m]=z,d(),M(),N()}function S(y,m){(s.highlights&&s.highlights[m]||[]).forEach(C=>{v(y,C)})}function v(y,m,x=null){if(!m||!m.text||y.querySelector(`[data-hl-id="${m.id}"]`))return null;let C=x;if(!C){const j=_(y,m.text);if(!j)return null;C=j.range}const I=C.extractContents(),$=document.createElement("span");return $.className="highlight-note",$.dataset.hlId=m.id,$.dataset.hlColor=n.includes(m.color)?m.color:"yellow",$.title=m.comment||"Kommentar",$.appendChild(I),C.insertNode($),$.addEventListener("click",j=>{j.stopPropagation(),y.classList.add("notes-open"),B(C,y,y.id||"",m)}),$}function A(y){var C,I,$,j;const m=((C=y.commonAncestorContainer)==null?void 0:C.nodeType)===1?y.commonAncestorContainer:(I=y.commonAncestorContainer)==null?void 0:I.parentElement,x=($=m==null?void 0:m.closest)==null?void 0:$.call(m,".highlight-note");return((j=x==null?void 0:x.dataset)==null?void 0:j.hlId)||""}function O(y){const m=y.parentNode;if(!m)return;const x=document.createDocumentFragment();for(;y.firstChild;)x.appendChild(y.firstChild);m.replaceChild(x,y),m.normalize()}function k(y){Object.keys(s.highlights||{}).forEach(m=>{s.highlights[m]=(s.highlights[m]||[]).filter(x=>x.id!==y)}),document.querySelectorAll(`.highlight-note[data-hl-id="${y}"]`).forEach(m=>O(m)),d()}function b(){document.addEventListener("selectionchange",T),document.addEventListener("mouseup",()=>{T(),L()}),document.addEventListener("keyup",T),document.addEventListener("contextmenu",y=>{const m=y.target.closest(".sheet");if(!m)return;const x=P(m);if(!x)return;y.preventDefault();const C=A(x.range);u={sheet:x.sheet,sheetId:x.sheetId,range:x.range,highlightId:C},E(y.clientX,y.clientY)}),document.addEventListener("click",y=>{if(p){p=!1;return}a&&(a.contains(y.target)||M())}),document.addEventListener("keydown",y=>{y.key==="Escape"&&(M(),N())})}function E(y,m){M({keepPending:!0}),a=document.createElement("div"),a.className="highlight-menu";const x=document.createElement("button");x.type="button",x.textContent="Highlight + Notiz",x.addEventListener("click",()=>{const j=u;M(),j&&B(j.range,j.sheet,j.sheetId)}),a.appendChild(x);const C=document.createElement("button");if(C.type="button",C.textContent="Text kopieren",C.addEventListener("click",()=>{var z,V;const j=u;if(!j)return;const Q=(((z=j.range)==null?void 0:z.toString())||"").trim();Q&&((V=navigator.clipboard)==null||V.writeText(Q).catch(()=>{})),M()}),a.appendChild(C),u!=null&&u.highlightId){const j=document.createElement("button");j.type="button",j.textContent="üóëÔ∏è",j.title="Highlight l√∂schen",j.addEventListener("click",()=>{k(u.highlightId),M()}),a.appendChild(j)}document.body.appendChild(a);const I=m+window.scrollY+6,$=y+window.scrollX+6;a.style.top=`${I}px`,a.style.left=`${$}px`,p=!0}function M(y={}){const{keepPending:m=!1}=y;a&&(a.remove(),a=null),m||(u=null)}function L(){var z,V;if(a||i)return;const y=window.getSelection();if(!y||y.isCollapsed)return;const m=y.getRangeAt(0).cloneRange(),x=m.commonAncestorContainer.nodeType===1?m.commonAncestorContainer:m.commonAncestorContainer.parentElement;if((z=x==null?void 0:x.closest)!=null&&z.call(x,".sheet-notes"))return;const C=(V=x==null?void 0:x.closest)==null?void 0:V.call(x,".sheet");if(!C)return;const I=A(m);u={sheet:C,sheetId:C.id||"",range:m,highlightId:I};const $=m.getBoundingClientRect(),j=$.right,Q=$.bottom;E(j,Q)}function B(y,m,x,C=null){N(),x||(x=m.id||""),i=document.createElement("div"),i.className="highlight-create",i.innerHTML=`
      <div style="display:flex; align-items:center; justify-content:space-between; gap:6px;">
        <div style="font-size:11px; font-weight:700;">Kommentar hinzuf√ºgen</div>
        <button type="button" class="hlc-close" aria-label="Schlie√üen">‚úï</button>
      </div>
      <div style="font-size:11px; margin:2mm 0; color:#555;">${(y.toString()||"").slice(0,120)}</div>
      <div class="hlc-color-row">
        ${n.map(K=>`<button type="button" class="hlc-color-btn" data-color="${K}" title="${K}" aria-label="Farbe ${K}"></button>`).join("")}
      </div>
      <textarea class="hlc-text" aria-label="Kommentar" placeholder="Kommentar (optional)"></textarea>
      <div class="highlight-editor__actions">
        <button type="button" class="hl-save">Speichern</button>
        ${C?'<button type="button" class="hl-delete" title="Highlight l√∂schen">üóëÔ∏è</button>':""}
        <button type="button" class="hl-cancel">Abbrechen</button>
      </div>
    `,document.body.appendChild(i);const I=y.getBoundingClientRect(),$=i.getBoundingClientRect();let j=I.bottom+window.scrollY+8,Q=I.left+window.scrollX;Q=Math.min(Q,window.scrollX+window.innerWidth-$.width-8),j=Math.max(8+window.scrollY,j),i.style.top=`${j}px`,i.style.left=`${Q}px`;const z=i.querySelector(".hlc-text"),V=Array.from(i.querySelectorAll(".hlc-color-btn"));let U=C&&n.includes(C.color)?C.color:"yellow";const J=()=>{V.forEach(K=>{const pe=K.dataset.color;K.classList.toggle("is-selected",pe===U)})};J(),V.forEach(K=>{K.addEventListener("click",()=>{U=K.dataset.color,J()})}),C&&(z.value=C.comment||"");const te=i.querySelector(".hl-save"),se=i.querySelector(".hl-delete"),he=i.querySelector(".hl-cancel"),Ne=i.querySelector(".hlc-close"),we=()=>N();te==null||te.addEventListener("click",()=>{const K=z.value.trim(),pe=U;if(C){C.comment=K,C.color=n.includes(pe)?pe:"yellow";const Pe=m.querySelector(`.highlight-note[data-hl-id="${C.id}"]`);Pe&&(Pe.title=K||"Kommentar",Pe.dataset.hlColor=C.color),d()}else w(m,x,y,K,pe);we()}),se==null||se.addEventListener("click",()=>{C&&(k(C.id),we())}),he==null||he.addEventListener("click",we),Ne==null||Ne.addEventListener("click",we)}function N(){i&&(i.remove(),i=null)}function T(){var I,$;const y=window.getSelection();if(!y||y.isCollapsed)return;const m=y.getRangeAt(0),x=($=(I=m.commonAncestorContainer.nodeType===1?m.commonAncestorContainer:m.commonAncestorContainer.parentElement)==null?void 0:I.closest)==null?void 0:$.call(I,".sheet");if(!x)return;const C=m.getBoundingClientRect();c={range:m.cloneRange(),sheet:x,sheetId:x.id||""},l=C}function P(y){const m=window.getSelection();if(m&&!m.isCollapsed){const x=m.getRangeAt(0).cloneRange();if(y.contains(x.commonAncestorContainer))return{range:x,sheet:y,sheetId:y.id||""}}return c&&c.sheet===y?{range:c.range.cloneRange(),sheet:y,sheetId:c.sheetId||y.id||"",rect:l}:null}function _(y,m){if(!m)return null;const x=document.createTreeWalker(y,NodeFilter.SHOW_TEXT,{acceptNode:I=>!I.parentElement||I.parentElement.closest(".sheet-notes, .highlight-note")?NodeFilter.FILTER_REJECT:!I.data||!I.data.trim()?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT});let C;for(;C=x.nextNode();){const I=C.data.indexOf(m);if(I!==-1){const $=document.createRange();return $.setStart(C,I),$.setEnd(C,I+m.length),{range:$}}}return null}function R(){const y=document.getElementById("notes-export");y&&y.addEventListener("click",()=>{H().catch(m=>console.error("Notes export failed",m))})}async function H(){s.docId=s.docId||ne(),s.sheetMeta=ae();const y=JSON.stringify(s,null,2),m=`<!DOCTYPE html>
`+document.documentElement.outerHTML,x=(C,I)=>{const $=document.createElement("a");$.href=URL.createObjectURL(I),$.download=C,document.body.appendChild($),$.click(),$.remove(),URL.revokeObjectURL($.href)};try{if(await e(),!window.JSZip)throw new Error("JSZip unavailable");const C=new JSZip;C.file("notes.json",y),C.file("document.html",m);const I=await C.generateAsync({type:"blob"});x("notes_bundle.zip",I)}catch(C){console.warn("Zip export failed, falling back to JSON",C),x("notes.json",new Blob([y],{type:"application/json"}))}}function F(){const y=document.getElementById("notes-import");if(!y)return;const m=document.createElement("input");m.type="file",m.accept=".json,.zip,application/json,application/zip",m.style.display="none",m.addEventListener("change",()=>{var C;const x=(C=m.files)==null?void 0:C[0];x&&(D(x).catch(I=>console.warn("Import failed",I)),m.value="")}),document.body.appendChild(m),y.addEventListener("click",async()=>{if(!ee()){m.click();return}const x=await ye();x!=="cancel"&&(x==="export-import"&&await H().catch(C=>console.error("Notes export failed",C)),m.click())})}function Z(y=[]){const m=ae(),x=new Map,C=new Map;m.forEach(z=>{z.slug&&x.set(z.slug,z),z.id&&C.set(z.id,z)});const I=(z,V)=>{if(z!=null&&z.slug&&x.has(z.slug))return x.get(z.slug);if(z!=null&&z.title){const U=m.find(J=>J.title===z.title);if(U)return U}return V&&C.has(V)?C.get(V):null},$=new Map;y.forEach(z=>$.set(z.id,z));const j={},Q={};Object.entries(s.notes||{}).forEach(([z,V])=>{const U=$.get(z),J=I(U,z),te=(J==null?void 0:J.id)||z,he=J&&U&&U.hash&&U.hash!==J.hash?`[Warnung] Seiteninhalt hat sich seit dem Export ge√§ndert. Bitte pr√ºfen.

`:"";j[te]=he+(V||"")}),Object.entries(s.highlights||{}).forEach(([z,V])=>{const U=$.get(z),J=I(U,z),te=(J==null?void 0:J.id)||z;Q[te]=Array.isArray(V)?V.slice():[]}),s.notes=j,s.highlights=Q,s.sheetMeta=m,d(),o.forEach((z,V)=>{var se;if(z.classList.contains("Titlepage"))return;const U=z.id||`sheet-${V+1}`,J=z.querySelector(".sheet-notes"),te=J==null?void 0:J.querySelector(".sheet-notes__area");te&&(te.value=((se=s.notes)==null?void 0:se[U])||""),g(z,U),S(z,U)})}return{initSheetNotes:f,initNoteExport:R,initNoteImport:F,initHighlightContextMenu:b};function ee(){const y=Object.values(s.notes||{}),m=Object.values(s.highlights||{}),x=y.some(I=>(I||"").trim().length>0),C=m.some(I=>Array.isArray(I)&&I.length>0);return x||C}async function D(y){if((y.name||"").toLowerCase().endsWith(".zip")){await G(y);return}const x=await y.text();ce(x)}async function G(y){if(await e(),!window.JSZip)throw new Error("JSZip unavailable for import");const m=await y.arrayBuffer(),x=await window.JSZip.loadAsync(m);let C=x.file(/notes\.json$/i)[0]||x.file(/\.json$/i)[0];if(!C)throw new Error("notes.json not found in zip");const I=await C.async("string");ce(I)}function ce(y){const m=JSON.parse(y||"{}");s={docId:m.docId||ne(),sheetMeta:Array.isArray(m.sheetMeta)?m.sheetMeta:[],notes:m.notes||{},highlights:m.highlights||{}},d(),Z(m.sheetMeta||[])}function ye(){return new Promise(y=>{const m=document.createElement("div");m.className="notes-import-modal";const x=document.createElement("div");x.className="notes-import-dialog",x.innerHTML=`
        <h3 class="notes-import-title">Vorhandene Notizen gefunden</h3>
        <p class="notes-import-text">Beim Import werden aktuelle Notizen und Highlights ersetzt. M√∂chtest du vorher exportieren?</p>
        <div class="notes-import-actions">
          <button type="button" data-action="export-import" class="primary">Exportieren &amp; importieren</button>
          <button type="button" data-action="import">Nur importieren</button>
          <button type="button" data-action="cancel" class="ghost">Abbrechen</button>
        </div>
      `,m.appendChild(x),document.body.appendChild(m);const C=$=>{m.remove(),document.removeEventListener("keydown",I),y($)},I=$=>{$.key==="Escape"&&C("cancel")};document.addEventListener("keydown",I),m.addEventListener("click",$=>{$.target===m&&C("cancel")}),x.querySelectorAll("button[data-action]").forEach($=>{$.addEventListener("click",()=>C($.dataset.action))})})}function ae(){return o.filter(y=>!y.classList.contains("Titlepage")).map(y=>{var x,C;const m={id:y.id||"",slug:y.dataset.linkSlug||ue(y.dataset.link||y.id||""),title:((C=(x=y.querySelector("[data-toc]"))==null?void 0:x.dataset)==null?void 0:C.toc)||y.id||""};return m.hash=Ie(le(y)),m})}function le(y){const m=document.createTreeWalker(y,NodeFilter.SHOW_TEXT,{acceptNode:I=>!I.parentElement||I.parentElement.closest(".sheet-notes")?NodeFilter.FILTER_REJECT:!I.data||!I.data.trim()?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT});let x="",C;for(;C=m.nextNode();)x+=C.data+" ";return x.replace(/\s+/g," ").trim()}function Ie(y){let m=0;for(let x=0;x<y.length;x+=1)m=m*31+y.charCodeAt(x)|0;return`h${(m>>>0).toString(16)}`}function ue(y){return(y||"").toString().trim().toLowerCase().replace(/['"()]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"")}function ne(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`doc-${Date.now().toString(36)}-${Math.random().toString(16).slice(2,8)}`}function de(){const y=document.getElementById("notes-toggle-all");if(!y)return;let m=!1;const x=()=>{y.textContent=m?"Alle Notizen schlie√üen":"Alle Notizen √∂ffnen"};x(),y.addEventListener("click",()=>{m=!m,o.forEach((C,I)=>{C.classList.contains("Titlepage")||C.classList.toggle("notes-open",m)}),x()})}}function yt(r){const{sheetAudio:e,audioRegistry:o,body:n,sheets:t,audioDefaults:s}=r;let a=(n.dataset.audioMode||s.mode||"manual").toLowerCase(),i=S(parseFloat(localStorage.getItem("sheetAudioVolume"))||1);const u=(()=>{let k=null;return()=>{k||(k=requestAnimationFrame(()=>{k=null,w()}))}})();function c(){l(),h(),e.length=0,t.forEach(b=>{var L;const E=(b.dataset.audioSrc||"").trim();if(!E)return;const M=(b.dataset.audioTitle||((L=b.querySelector("[data-toc]"))==null?void 0:L.textContent)||"Audio").trim();e.push({sheet:b,src:E,title:M})});const k=Array.from(document.querySelectorAll('input[name="audio-mode"]'));if(k.length){const b=(localStorage.getItem("sheetAudioMode")||"").toLowerCase();b==="manual"||b==="autoplay"?a=b:(a="manual",localStorage.setItem("sheetAudioMode",a)),k.forEach(E=>{E.checked=E.value.toLowerCase()===a,E.addEventListener("change",M=>{a=(M.target.value||"manual").toLowerCase(),localStorage.setItem("sheetAudioMode",a),d()})})}d(),A()}function l(){if(n.dataset.audioExclusiveBound==="true")return;n.dataset.audioExclusiveBound="true";const k=b=>{const E=b.target;!E||E.tagName!=="AUDIO"||(p(E),requestAnimationFrame(()=>p(E)))};document.addEventListener("play",k,!0),document.addEventListener("playing",k,!0)}function p(k){o.forEach(({audio:b})=>{b&&b!==k&&b.pause()}),document.querySelectorAll("audio").forEach(b=>{if(b!==k)try{b.pause()}catch{}})}function h(){n.dataset.audioFooterToggleBound!=="true"&&(n.dataset.audioFooterToggleBound="true",document.addEventListener("click",k=>{var L,B;const b=(B=(L=k.target)==null?void 0:L.closest)==null?void 0:B.call(L,".page-footer__title");if(!b)return;const E=b.closest(".page-footer");if(!E)return;const M=E.querySelector("audio.sheet-audio__hidden");M&&(k.preventDefault(),k.stopPropagation(),M.paused?(p(M),M.play().catch(()=>{})):M.pause())},!0))}function d(){if(o.forEach(({audio:b})=>b.pause()),o.length=0,document.querySelectorAll(".sheet-audio").forEach(b=>b.remove()),document.querySelectorAll(".sheet-audio__progress").forEach(b=>b.remove()),document.querySelectorAll(".sheet-audio__scrubber").forEach(b=>b.remove()),document.querySelectorAll(".page-footer.has-audio").forEach(b=>{var E;b.classList.remove("has-audio"),b.style.setProperty("--audio-progress","0%"),(E=b.querySelector(".page-footer__title"))==null||E.classList.remove("is-playing")}),a==="off")return;const k=(b,E)=>{b.classList.add("has-audio");const M=document.createElement("div");M.className="sheet-audio sheet-audio--footer";const L=document.createElement("audio");L.preload="metadata",L.src=E.src,L.setAttribute("title",E.title),L.className="sheet-audio__hidden",O(L);const B=document.createElement("div");B.className="sheet-audio__progress",b.prepend(B);const N=document.createElement("input");N.type="range",N.className="sheet-audio__scrubber",N.min="0",N.max="100",N.step="0.1",N.value="0",b.prepend(N);let T=!1;const P=b.querySelector(".page-footer__title"),_=()=>{if(!L.duration||Number.isNaN(L.duration))return;const D=Math.min(100,Math.max(0,L.currentTime/L.duration*100));b.style.setProperty("--audio-progress",`${D}%`),T||(N.value=`${D}`)},R=()=>{P&&(L.paused?P.classList.remove("is-playing"):P.classList.add("is-playing"))};L.addEventListener("timeupdate",_),L.addEventListener("loadedmetadata",_),L.addEventListener("loadedmetadata",()=>O(L)),L.addEventListener("ended",()=>{b.style.setProperty("--audio-progress","0%"),R()}),L.addEventListener("play",()=>{p(L),R()}),L.addEventListener("pause",R),L.addEventListener("play",()=>O(L));const H=D=>{const G=B.getBoundingClientRect();return G.width?(D-G.left)/G.width:0},F=D=>{if(!L.duration||Number.isNaN(L.duration))return;const G=Math.min(1,Math.max(0,D));L.currentTime=G*L.duration,b.style.setProperty("--audio-progress",`${G*100}%`),N.value=`${G*100}`};N.addEventListener("pointerdown",D=>{!L.duration||Number.isNaN(L.duration)||(T=!0,D.pointerId!==void 0&&N.setPointerCapture(D.pointerId),F(H(D.clientX)))}),N.addEventListener("pointermove",D=>{T&&F(H(D.clientX))});const Z=D=>{T&&(T=!1,D.pointerId!==void 0&&N.hasPointerCapture(D.pointerId)&&N.releasePointerCapture(D.pointerId))};N.addEventListener("pointerup",Z),N.addEventListener("pointercancel",Z),N.addEventListener("input",D=>{if(!L.duration||Number.isNaN(L.duration))return;const G=Math.min(100,Math.max(0,parseFloat(D.target.value)||0))/100;F(G)}),M.append(L),b.appendChild(M);const ee=b.closest(".sub-page-sheet")||b.closest(".sheet");o.push({audio:L,container:ee}),R()};e.forEach(b=>{const E=[],M=b.sheet.querySelector(":scope > .page-footer")||b.sheet.querySelector(".page-footer");M&&E.push(M),b.sheet.querySelectorAll(":scope .sub-page-sheet .page-footer").forEach(L=>E.push(L)),E.forEach(L=>k(L,b))}),A(),a==="autoplay"?w():u()}function f(k){const b=o.filter(({container:M})=>M==null?void 0:M.closest("#subsheet-content")),E=o.filter(({container:M})=>!(M!=null&&M.closest("#subsheet-content")));return k&&b.length?b:!k&&E.length?E:b.length?b:E}function g(){const k=document.body.classList.contains("panel-open");let b={x:window.innerWidth/2,y:window.innerHeight/2};if(k){const N=document.getElementById("subsheet-content"),T=N==null?void 0:N.getBoundingClientRect();T&&(b={x:T.left+T.width/2,y:T.top+T.height/2})}const E=f(k);if(!E.length)return null;let M=null,L=1/0,B=!1;return E.forEach(N=>{var F;const T=(F=N.container)==null?void 0:F.getBoundingClientRect();if(!T)return;const P=b.x>=T.left&&b.x<=T.right&&b.y>=T.top&&b.y<=T.bottom,_=T.left+T.width/2,R=T.top+T.height/2,H=Math.hypot(_-b.x,R-b.y);if(P&&!B){M=N,L=H,B=!0;return}if(P&&H<L){M=N,L=H;return}!B&&H<L&&(M=N,L=H)}),(M==null?void 0:M.audio)||null}function w(){if(a!=="autoplay")return;const k=g();k&&p(k),a==="autoplay"&&k&&k.play().catch(()=>{})}function S(k){return Number.isFinite(k)?Math.min(1,Math.max(0,k)):1}function v(){const k=document.getElementById("audio-volume");if(!k)return;k.value=String(i);const b=()=>{const E=Number.isFinite(k.valueAsNumber)?k.valueAsNumber:parseFloat(k.value),M=S(E);i=M,localStorage.setItem("sheetAudioVolume",String(M)),A()};k.addEventListener("input",b),k.addEventListener("change",b)}return{initAudioControls:c,renderSheetAudio:d,requestAudioUpdate:u,updateAutoplayFocus:w,bindVolumeControl:v};function A(){o.forEach(({audio:k})=>O(k))}function O(k){if(k)try{const b=S(i);k.muted=b===0,k.volume=b}catch{}}}function wt(r){const{videoEntries:e}=r;let o;function n(){return window.YT&&window.YT.Player?Promise.resolve():o||(o=new Promise(p=>{const h=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=()=>{h==null||h(),p()};const d=document.createElement("script");d.src="https://www.youtube.com/iframe_api",d.async=!0,document.head.appendChild(d)}),o)}function t(){const p=Array.from(document.querySelectorAll(".video-entry[data-video-id]"));p.length&&p.forEach((h,d)=>{var M,L;const f=h.closest(".sheet"),g=Number((f==null?void 0:f.dataset.pageNumber)||d+1),w=e.length+1,S=(h.dataset.videoId||"").trim();if(!S)return;const v=(h.dataset.videoTitle||((M=h.querySelector("figcaption"))==null?void 0:M.textContent)||`Video ${d+1}`).trim(),A=(h.dataset.videoCaption||((L=h.querySelector("figcaption"))==null?void 0:L.textContent)||"").trim(),O=`https://www.youtube-nocookie.com/embed/${S}`,k=`https://youtu.be/${S}`;let b=h.querySelector(".video-frame");b||(b=document.createElement("div"),b.className="video-frame",h.prepend(b)),b.innerHTML="",b.appendChild(c({url:O,title:v,shareUrl:k,iframeId:`yt-embed-${S}-${w}`})),b.appendChild(u(k,v));let E=h.querySelector("figcaption");E||(E=document.createElement("figcaption"),h.appendChild(E)),E.textContent=`Video ${w}: ${A||v}`,e.push({title:v,caption:A,videoId:S,url:O,shareUrl:k,sheet:f,page:g,idx:d,number:w})})}function s(){const p=document.getElementById("video-list");if(p){if(p.innerHTML="",!e.length){const h=document.createElement("li");h.textContent="(keine Videos markiert)",p.appendChild(h);return}e.forEach(h=>{var S;const d=document.createElement("li");d.className="toc-item",d.dataset.target=((S=h.sheet)==null?void 0:S.id)||"",d.setAttribute("role","button"),d.tabIndex=0;const f=document.createElement("span");f.className="toc-number",f.textContent=`${h.number}.`;const g=document.createElement("span");g.className="toc-title",g.textContent=`Video ${h.number}: ${h.title}`;const w=document.createElement("span");w.className="toc-page",w.textContent=h.page,d.append(f,g,w),p.appendChild(d)}),p.addEventListener("click",h=>{const d=h.target.closest(".toc-item[data-target]");if(!d)return;const f=d.dataset.target;if(!f)return;const g=document.getElementById(f);g&&(g.scrollIntoView({behavior:"smooth",block:"start"}),document.body.classList.remove("panel-open"))})}}function a(p,h,d){const f=document.createElement("iframe"),g=p.includes("?")?"&":"?";return f.src=`${p}${g}enablejsapi=1&rel=0&playsinline=1`,f.title=h||"YouTube Video",f.loading="lazy",f.allowFullscreen=!0,f.referrerPolicy="strict-origin-when-cross-origin",d&&(f.id=d),f}function i(p){const h=document.createElement("div");return h.className="video-embed",h.appendChild(p),h}function u(p,h){const d=document.createElement("img");d.alt=h||"Video QR",d.className="video-qr";const f=encodeURIComponent(p);d.src=`https://api.qrserver.com/v1/create-qr-code/?size=220x220&data=${f}`;const g=document.createElement("div");g.className="video-qr-wrapper",g.appendChild(d);const w=document.createElement("div");w.className="video-qr-caption";const S=document.createElement("a");return S.href=p,S.target="_blank",S.rel="noreferrer noopener",S.textContent=p,w.appendChild(S),g.appendChild(w),g}return{initVideos:t,buildVideoList:s,buildVideoIframe:a,buildVideoQr:u};function c({url:p,title:h,shareUrl:d,iframeId:f}){const g=document.createElement("div");g.className="video-embed video-embed--placeholder";const w=document.createElement("div");w.className="video-placeholder";const S=document.createElement("div");S.className="video-placeholder__info",S.textContent=h||"Video";const v=document.createElement("button");return v.type="button",v.className="video-placeholder__btn",v.textContent="Youtube Video Anzeigen",v.addEventListener("click",()=>{const A=a(p,h,f);g.replaceWith(i(A)),l(A)}),w.append(S,v),g.appendChild(w),g}function l(p){p&&n().then(()=>{var h;(h=window.YT)!=null&&h.Player&&new window.YT.Player(p,{host:"https://www.youtube-nocookie.com",playerVars:{rel:0,playsinline:1,modestbranding:1},events:{onStateChange:d=>{if(d.data===window.YT.PlayerState.ENDED)try{d.target.stopVideo()}catch{}}}})}).catch(()=>{})}}function St(){const r=Array.from(document.querySelectorAll(".python-script-block"));if(!r.length)return;const e=n=>{if(!n)return;const t=n.textContent||n.innerText||"",s=u=>u.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),a=[{type:"comment",regex:/#[^\n]*/g},{type:"string",regex:/(\"\"\"[\s\S]*?\"\"\"|'''[\s\S]*?'''|"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*')/g},{type:"number",regex:/\b\d+(?:\.\d+)?\b/g},{type:"keyword",regex:/\b(and|as|assert|async|await|break|class|continue|def|del|elif|else|except|False|finally|for|from|global|if|import|in|is|lambda|None|nonlocal|not|or|pass|raise|return|True|try|while|with|yield)\b/g},{type:"builtin",regex:/\b(print|len|range|enumerate|dict|list|set|tuple|float|int|str|Path|open|sum|min|max|zip|map|filter|all|any|sorted)\b/g}];let i=s(t);a.forEach(({type:u,regex:c})=>{i=i.replace(c,l=>`<span class="code-token ${u}">${s(l)}</span>`)}),n.innerHTML=i},o=async n=>{try{return await navigator.clipboard.writeText(n),!0}catch{try{const s=document.createElement("textarea");s.value=n,s.style.position="fixed",s.style.top="-500px",document.body.appendChild(s),s.focus(),s.select();const a=document.execCommand("copy");return s.remove(),a}catch(s){return console.warn("Copy failed",s),!1}}};r.forEach(n=>{const t=n.querySelector(".code-full"),s=n.querySelector(".code-preview");if(!t)return;const a=(t.textContent||"").trim();if(!a)return;e(t.querySelector("code")||t),s&&e(s.querySelector("code")||s);const i=document.createElement("div");i.className="code-actions";const u=document.createElement("button");u.type="button",u.textContent="Ganzes Skript kopieren",u.addEventListener("click",async()=>{const d=await o(a)?"Kopiert!":"Kopieren fehlgeschlagen",f=u.textContent;u.textContent=d,setTimeout(()=>{u.textContent=f},1800)});let c=!1;const l=document.createElement("button");l.type="button",l.className="secondary";const p=()=>{t.hidden=!c,t.classList.toggle("is-expanded",c),n.classList.toggle("is-expanded",c),l.textContent=c?"Vollst√§ndiges Skript ausblenden":"Vollst√§ndiges Skript anzeigen";const h=n.closest(".sheet");h&&h.classList.toggle("is-code-expanded",c)};p(),l.addEventListener("click",()=>{c=!c,p()}),i.append(u,l),n.appendChild(i)})}function vt(r){const{body:e}=r,o=Array.from(document.querySelectorAll('input[name="theme-mode"]'));let t=(localStorage.getItem("sheetTheme")||"").toLowerCase()==="dark"?"dark":"light";const s=(u,c=!0)=>{const l=u==="dark"?"dark":"light";t=l,window.sheetThemeMode=l,e.classList.toggle("theme-dark",l==="dark"),e.classList.toggle("theme-light",l==="light"),document.documentElement.setAttribute("data-theme",l),o.forEach(p=>{p.checked=(p.value||"").toLowerCase()===l}),c&&localStorage.setItem("sheetTheme",l)};s(t,!1),o.forEach(u=>{u.addEventListener("change",c=>{const l=(c.target.value||"light").toLowerCase();s(l)})});const a=()=>{e.dataset.prevTheme=t,s("light",!1)},i=()=>{const u=e.dataset.prevTheme||t||"light";s(u,!1)};window.addEventListener("beforeprint",a),window.addEventListener("afterprint",i)}function xt(r,{ensureJSZip:e}){const{sheets:o,body:n}=r,t=document.getElementById("print-confirm"),s=document.getElementById("print-save"),a=document.getElementById("print-include-subsheets-yes"),i=document.getElementById("print-include-subsheets-no"),u=document.getElementById("print-include-fullcode"),c=document.getElementById("print-include-fullcode-main"),l=document.getElementById("print-modal"),p=document.getElementById("print-include-subsheets");if(!t||!s)return;const h=new Date().toISOString().slice(0,10);let d=[];const f=()=>a&&!i?a.checked||a.hasAttribute("checked"):a&&i?a.checked||!a.checked&&!i.checked&&a.hasAttribute("checked"):p?p.checked:!0,g=()=>!!(u&&u.checked||c&&c.checked),w=()=>{d.forEach(E=>E.remove()),d=[]},S=()=>{w(),o.forEach(E=>{const M=Array.from(E.querySelectorAll(".sub-page-sheet"));if(!M.length)return;const L=document.createElement("div");L.className="print-subpages",E.id&&(L.dataset.printSourceSheetId=E.id),M.forEach(B=>L.appendChild(B.cloneNode(!0))),E.insertAdjacentElement("afterend",L),d.push(L)})},v=()=>{const E=new Map,M=new Map,L=45;document.querySelectorAll(".code-full").forEach(B=>{const N=(B.textContent||"").trim();if(!N)return;const T=B.closest(".sheet");if(!T)return;const P=B.closest(".sub-page-sheet"),_=T.id||T.dataset.pageNumber||`sheet-${M.size+1}`;let R=(M.get(_)||0)+1;const H=(Z,ee)=>{var y,m;const D=document.createElement("section");D.className="sheet libertinus padding-20mm code-print-sheet";const G=P&&P.querySelector(".page-header")||T.querySelector(":scope > .page-header");if(G){const x=G.cloneNode(!0);D.appendChild(x)}const ce=document.createElement("article");ce.innerHTML="<strong>Code (vollst√§ndig)</strong>",D.appendChild(ce);const ye=document.createElement("pre"),ae=document.createElement("code");ae.textContent=Z,ye.appendChild(ae),D.appendChild(ye);const le=document.createElement("div");le.className="page-footer";const Ie=((y=T.querySelector(".page-footer__title"))==null?void 0:y.textContent)||((m=T.querySelector(":scope > .page-header"))==null?void 0:m.textContent)||"Code",ue=document.createElement("span");ue.className="page-footer__title",ue.textContent=Ie;const ne=document.createElement("span");ne.className="code-page-number",ne.textContent=`c${ee}`,le.append(ue,ne),D.appendChild(le);let de=E.get(T);de||(de=d.slice().reverse().find(x=>{var C;return T.id&&((C=x.dataset)==null?void 0:C.printSourceSheetId)===T.id})||T),de.insertAdjacentElement("afterend",D),E.set(T,D),d.push(D)},F=N.split(/\r?\n/);for(let Z=0;Z<F.length;Z+=L){const ee=F.slice(Z,Z+L).join(`
`);H(ee,R),R+=1}M.set(_,R-1)})};t.addEventListener("click",()=>{f()?S():w(),g()&&v(),l==null||l.setAttribute("hidden","true"),window.print()});const A=async E=>{const M=async T=>(await fetch(T)).text(),L=async(T,P)=>{const _=/@import\\s+url\\(([^)]+)\\)\\s*;?/g;let R,H=T;for(;(R=_.exec(T))!==null;){const F=R[1].replace(/['"]/g,"").trim();if(F)try{const Z=F.startsWith("http")?F:new URL(F,P).toString(),ee=await M(Z);H=H.replace(R[0],ee)}catch(Z){console.warn("Inline @import failed for",F,Z)}}return H},B=Array.from(E.querySelectorAll('link[rel="stylesheet"]'));for(const T of B){const P=T.getAttribute("href")||"";try{const _=P.startsWith("http")?P:new URL(P,document.baseURI).toString(),R=await M(_),H=await L(R,_),F=E.createElement("style");F.textContent=H,T.replaceWith(F)}catch(_){console.warn("Inline CSS failed for",P,_)}}const N=Array.from(E.querySelectorAll("script[src]"));for(const T of N){const P=T.getAttribute("src")||"";if(!P.toLowerCase().includes("mathjax"))try{const _=P.startsWith("http")?P:new URL(P,document.baseURI).toString(),R=await M(_),H=E.createElement("script");H.textContent=R,T.replaceWith(H)}catch(_){console.warn("Inline JS failed for",P,_)}}},O=async(E,M)=>{const L=Array.from(M.querySelectorAll("script[src*='mathjax']"));if(!L.length)return;L.forEach(N=>N.setAttribute("src","mathjax.js"));const B=[n.dataset.mathjaxSrc||"node_modules/mathjax/es5/tex-mml-chtml.js","https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"];for(const N of B)try{const T=N.startsWith("http")?N:new URL(N,document.baseURI).toString(),P=await fetch(T);if(!P.ok)continue;const _=await P.text();E.file("mathjax.js",_);return}catch{continue}},k=async()=>{var T;f()?S():w(),g()&&v();const M=document.documentElement.cloneNode(!0);(T=M.querySelector("body"))==null||T.classList.add("offline-export");try{await A(M)}catch(P){console.warn("Inline assets failed",P)}const L="<!DOCTYPE html>\\n"+M.outerHTML,B=(P,_)=>{const R=document.createElement("a");R.href=URL.createObjectURL(_),R.download=P,document.body.appendChild(R),R.click(),R.remove(),URL.revokeObjectURL(R.href)},N=()=>B("document.html",new Blob([L],{type:"text/html"}));try{if(await Promise.race([e(),new Promise((R,H)=>setTimeout(()=>H(new Error("JSZip timeout")),3e3))]),!window.JSZip)throw new Error("JSZip unavailable");const P=new JSZip;P.file("document.html",L),await O(P,M);const _=await P.generateAsync({type:"blob"});B("document.zip",_)}catch(P){console.warn("Zip export failed, falling back to HTML",P),N()}document.body.classList.remove("offline-export"),w(),b()};o.forEach(E=>{E.querySelectorAll(".page-footer").forEach(M=>{M.setAttribute("data-print-date",h)}),E.querySelectorAll(".sub-page-sheet .page-footer").forEach(M=>{M.setAttribute("data-print-date",h)})}),s.addEventListener("click",()=>{k().catch(E=>console.error("Offline export failed",E))});const b=()=>l==null?void 0:l.setAttribute("hidden","true");window.addEventListener("afterprint",w)}function Et(r){if(!r)return"‚Äì";const e=new Date(r);return Number.isNaN(e.getTime())?r:e.toLocaleDateString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit"})}function kt(r){const{body:e,userSettings:o}=r,n=(e.dataset.repoUrl||o.repoUrl||"").trim()||"https://github.com/Seren200018/Vorlesung-Skript-Template",t=document.querySelector("[data-build-target='repo']");t&&(t.textContent=n,t.href!==void 0&&(t.href=n));const s=document.querySelector("[data-build-target='date']");s&&(s.textContent=Et(At(e,o)));const a=document.querySelector("[data-build-target='author']");a&&(a.textContent=(e.dataset.author||o.author||"Autor / Dozent").trim());const i=document.querySelector("[data-build-target='version']");i&&(i.textContent=(e.dataset.packageVersion||o.version||"unbekannt").trim());const u=document.querySelector("[data-build-target='copyright']");if(u){const c=(e.dataset.license||o.license||"CC BY-NC 4.0").trim();u.textContent=c,Ct(u,c)}}function Ct(r,e){var t;if(!r)return;(t=r.querySelector(".cc-badges"))==null||t.remove();const o=Mt(e);if(!o.length)return;const n=document.createElement("span");n.className="cc-badges",o.forEach(s=>{const a=document.createElement("span");a.className="cc-badge",a.title=`Creative Commons ${s}`,a.innerHTML=Lt(s),n.appendChild(a)}),r.appendChild(n)}function Mt(r){const e=(r||"").toUpperCase(),o=[];return e.includes("CC")&&(o.push("CC"),["BY","SA","ND","NC"].forEach(t=>{e.includes(t)&&o.push(t)}),(e.includes("0")||e.includes("ZERO"))&&o.push("0")),o}function Lt(r){const e=(r||"").toUpperCase(),o='<circle cx="10" cy="10" r="9" fill="currentColor" opacity="0.15" stroke="currentColor" stroke-width="1.1"/>';return e==="CC"?`<svg viewBox="0 0 20 20" aria-hidden="true" focusable="false">${o}<text x="10" y="13" text-anchor="middle" font-size="8" font-weight="700" fill="currentColor">CC</text></svg>`:e==="BY"?`<svg viewBox="0 0 20 20" aria-hidden="true" focusable="false">${o}<circle cx="10" cy="8" r="2.4" fill="currentColor"/><rect x="7" y="11" width="6" height="4.6" rx="1" fill="currentColor"/></svg>`:e==="NC"?`<svg viewBox="0 0 20 20" aria-hidden="true" focusable="false">${o}<text x="10" y="9.5" text-anchor="middle" font-size="6.5" font-weight="700" fill="currentColor">$</text><line x1="6" y1="6" x2="14" y2="14" stroke="currentColor" stroke-width="1.4"/></svg>`:e==="SA"?`<svg viewBox="0 0 20 20" aria-hidden="true" focusable="false">${o}<path d="M12.2 6.4 15 8l-2.8 1.6V8.9c-2.5 0-4.4 1.2-4.4 4.2 0-3 1.9-5.1 4.4-5.1V6.4Z" fill="currentColor"/></svg>`:e==="ND"?`<svg viewBox="0 0 20 20" aria-hidden="true" focusable="false">${o}<rect x="5" y="8" width="10" height="1.6" rx="0.5" fill="currentColor"/><rect x="5" y="11" width="10" height="1.6" rx="0.5" fill="currentColor"/></svg>`:e==="0"?`<svg viewBox="0 0 20 20" aria-hidden="true" focusable="false">${o}<text x="10" y="13" text-anchor="middle" font-size="9" font-weight="700" fill="currentColor">0</text></svg>`:`<svg viewBox="0 0 20 20" aria-hidden="true" focusable="false">${o}<text x="10" y="13" text-anchor="middle" font-size="8" font-weight="700" fill="currentColor">${e}</text></svg>`}function At(r,e){const o=[r.dataset.gitLastMod,r.dataset.repoModified,e.gitLastMod,document.lastModified].filter(Boolean).map(i=>i.toString().trim()).filter(Boolean).map(i=>new Date(i)).filter(i=>!Number.isNaN(i.getTime())),t=Date.now()+1e3*60*60*24,s=o.filter(i=>i.getTime()<=t);return s.length?s.reduce((i,u)=>i.getTime()>u.getTime()?i:u).toISOString():""}function We(){const r=document.getElementById("literature-list"),e=Array.from(document.querySelectorAll(".doi-citation"));if(!r)return;const o=new Map,n=(t,s,a)=>{const i=t||"Autor",u=s||"o.J.",c=a?`, ${a}`:"";return`(${i} ${u}${c})`};if(e.forEach((t,s)=>{const a=(t.dataset.author||"").trim(),i=(t.dataset.year||"").trim(),u=(t.dataset.pages||"").trim(),c=(t.dataset.title||"").trim(),l=(t.dataset.journal||"").trim(),p=(t.dataset.doi||"").trim(),h=(t.dataset.url||"").trim(),d=p?`https://doi.org/${p}`:h,f=document.createElement(d?"a":"span");f.textContent=n(a,i,u),d&&(f.href=d,f.target="_blank",f.rel="noreferrer noopener"),t.innerHTML="",t.appendChild(f);const g=p||`${a}-${i}-${c}`||`entry-${s}`;o.has(g)||o.set(g,{author:a||"o. Autor",year:i||"o.J.",pages:u,title:c,journal:l,doi:p,link:d})}),r.innerHTML="",!o.size){const t=document.createElement("li");t.textContent="(keine Eintr√§ge markiert)",r.appendChild(t);return}o.forEach(t=>{const s=document.createElement("li");s.className="literature-item";const a=[];(t.author||t.year)&&a.push(`${t.author} (${t.year})`),t.title&&a.push(t.title),t.journal&&a.push(t.journal),t.pages&&a.push(t.pages);const i=a.filter(Boolean).join(". ");if(t.link){const u=document.createElement("span");u.textContent=i||"Quelle";const c=document.createElement("a");c.href=t.link,c.textContent=t.doi?`DOI: ${t.doi}`:t.link,c.target="_blank",c.rel="noreferrer noopener",s.append(u),s.append(" ‚Äì "),s.append(c)}else s.textContent=i||"Quelle";r.appendChild(s)})}function Tt(){const r=document.documentElement;if(!document.getElementById("zoom-controls"))return;const o=document.getElementById("subsheet-panel"),n=document.getElementById("subsheet-zoom"),t=document.getElementById("subsheet-content"),s=document.getElementById("zoom-in"),a=document.getElementById("zoom-out"),i=document.getElementById("zoom-reset");if(!s||!a||!i)return;const u="sheetZoomScale",c=.5,l=2,p=.1,h=b=>Math.min(l,Math.max(c,b)),d=b=>Math.round(b*10)/10;let f=1;const g=parseFloat(localStorage.getItem(u));Number.isFinite(g)&&(f=h(g));let w=(o==null?void 0:o.getBoundingClientRect().width)||0;const S=()=>{i.textContent=`${Math.round(f*100)}%`},v=()=>{if(!n||!t)return;n.style.width=`${f*100}%`,t.style.width=`${100/f}%`;const b=t.scrollHeight;b&&(n.style.height=`${b*f}px`)},A=()=>{r.style.setProperty("--sheet-scale",String(f)),w>0&&r.style.setProperty("--panel-width",`${Math.round(w*f)}px`),v(),localStorage.setItem(u,String(f)),S()};let O=null;window.addEventListener("resize",()=>{o&&(O||(O=requestAnimationFrame(()=>{O=null;const b=o.getBoundingClientRect().width;w=f?b/f:b,A()})))});let k=null;t&&n&&new MutationObserver(()=>{k||(k=requestAnimationFrame(()=>{k=null,v()}))}).observe(t,{childList:!0,subtree:!0}),s.addEventListener("click",()=>{f=h(d(f+p)),A()}),a.addEventListener("click",()=>{f=h(d(f-p)),A()}),i.addEventListener("click",()=>{f=1,A()}),A()}function ge(r){return((r==null?void 0:r.textContent)||"").replace(/\s+/g," ").trim()}function It(r){const e=r.querySelector("[data-title-author]")||r.querySelector(".Titlepage.Author")||r.querySelector(".titlepage-author")||r.querySelector("#titlepage-author"),o=ge(e);if(o)return o;const n=r.querySelector(".abstract")||r,s=Array.from(n.querySelectorAll("p, h1, h2, h3, div, span")).filter(a=>!(a.closest(".Titlepage.Series, .Titlepage.Title, .Titlepage.Subtitle")||a.matches(".Titlepage.Series, .Titlepage.Title, .Titlepage.Subtitle")));for(let a=s.length-1;a>=0;a-=1){const i=ge(s[a]);if(i)return i}return""}function Nt(r){const{body:e}=r,o=document.querySelector(".sheet.Titlepage")||document.querySelector(".Titlepage");if(!o)return;const n=ge(o.querySelector("[data-title-series]")||o.querySelector(".Titlepage.Series")),t=ge(o.querySelector("[data-title-main]")||o.querySelector(".Titlepage.Title")),s=ge(o.querySelector("[data-title-subtitle]")||o.querySelector(".Titlepage.Subtitle")),a=It(o);t&&(e.dataset.lectureTitle=t),n&&(e.dataset.lectureSeries=n),s&&(e.dataset.lectureSubtitle=s),a&&(e.dataset.author=a),r.lectureTitle=e.dataset.lectureTitle||r.lectureTitle,r.lectureChapter=e.dataset.lectureChapter||r.lectureChapter}function Pt(r={}){const e=it(r),o=ct(e),n=lt(e),t=bt(e,{ensureJSZip:n.ensureJSZip}),s=yt(e),a=wt(e);return window.addEventListener("scroll",s.requestAudioUpdate,{passive:!0}),window.addEventListener("resize",s.requestAudioUpdate),W("numberSubpages",()=>dt(e)),W("syncMetadataFromTitlePage",()=>Nt(e)),W("initSubsheetPanel",()=>ut({typeset:o.typeset,requestAudioUpdate:s.requestAudioUpdate})),W("buildTocAndPageChrome",()=>ht(e)),W("buildSymbolColumns",()=>mt(e,o.typeset)),W("buildAssetLists",()=>gt(e)),W("populateBuildInfo",()=>kt(e)),W("initAudioControls",()=>{s.initAudioControls(),s.bindVolumeControl()}),W("initVideos",()=>a.initVideos()),W("buildVideoList",()=>a.buildVideoList()),W("buildLiteratureIndex",()=>We()),W("initPythonDemos",St),W("initThemeSwitch",()=>vt(e)),W("initZoomControls",()=>Tt()),W("initPrintDialog",()=>xt(e,{ensureJSZip:n.ensureJSZip})),W("initSheetNotes",()=>t.initSheetNotes()),W("initNoteExport",()=>t.initNoteExport()),W("initNoteImport",()=>t.initNoteImport()),W("initHighlightContextMenu",()=>t.initHighlightContextMenu()),window.addEventListener("load",()=>{W("initVideos (load)",()=>a.initVideos()),W("buildVideoList (load)",()=>a.buildVideoList()),W("buildLiteratureIndex (load)",()=>We()),W("renderSheetAudio (load)",()=>s.renderSheetAudio())}),{context:e,math:o,zip:n,audio:s,videos:a,notes:t}}function qe(r,e,o){if(r&&r.length){const[n,t]=e,s=Math.PI/180*o,a=Math.cos(s),i=Math.sin(s);for(const u of r){const[c,l]=u;u[0]=(c-n)*a-(l-t)*i+n,u[1]=(c-n)*i+(l-t)*a+t}}}function $t(r,e){return r[0]===e[0]&&r[1]===e[1]}function qt(r,e,o,n=1){const t=o,s=Math.max(e,.1),a=r[0]&&r[0][0]&&typeof r[0][0]=="number"?[r]:r,i=[0,0];if(t)for(const c of a)qe(c,i,t);const u=function(c,l,p){const h=[];for(const v of c){const A=[...v];$t(A[0],A[A.length-1])||A.push([A[0][0],A[0][1]]),A.length>2&&h.push(A)}const d=[];l=Math.max(l,.1);const f=[];for(const v of h)for(let A=0;A<v.length-1;A++){const O=v[A],k=v[A+1];if(O[1]!==k[1]){const b=Math.min(O[1],k[1]);f.push({ymin:b,ymax:Math.max(O[1],k[1]),x:b===O[1]?O[0]:k[0],islope:(k[0]-O[0])/(k[1]-O[1])})}}if(f.sort((v,A)=>v.ymin<A.ymin?-1:v.ymin>A.ymin?1:v.x<A.x?-1:v.x>A.x?1:v.ymax===A.ymax?0:(v.ymax-A.ymax)/Math.abs(v.ymax-A.ymax)),!f.length)return d;let g=[],w=f[0].ymin,S=0;for(;g.length||f.length;){if(f.length){let v=-1;for(let A=0;A<f.length&&!(f[A].ymin>w);A++)v=A;f.splice(0,v+1).forEach(A=>{g.push({s:w,edge:A})})}if(g=g.filter(v=>!(v.edge.ymax<=w)),g.sort((v,A)=>v.edge.x===A.edge.x?0:(v.edge.x-A.edge.x)/Math.abs(v.edge.x-A.edge.x)),(p!==1||S%l==0)&&g.length>1)for(let v=0;v<g.length;v+=2){const A=v+1;if(A>=g.length)break;const O=g[v].edge,k=g[A].edge;d.push([[Math.round(O.x),w],[Math.round(k.x),w]])}w+=p,g.forEach(v=>{v.edge.x=v.edge.x+p*v.edge.islope}),S++}return d}(a,s,n);if(t){for(const c of a)qe(c,i,-t);(function(c,l,p){const h=[];c.forEach(d=>h.push(...d)),qe(h,l,p)})(u,i,-t)}return u}function be(r,e){var o;const n=e.hachureAngle+90;let t=e.hachureGap;t<0&&(t=4*e.strokeWidth),t=Math.round(Math.max(t,.1));let s=1;return e.roughness>=1&&(((o=e.randomizer)===null||o===void 0?void 0:o.next())||Math.random())>.7&&(s=t),qt(r,t,n,s||1)}class He{constructor(e){this.helper=e}fillPolygons(e,o){return this._fillPolygons(e,o)}_fillPolygons(e,o){const n=be(e,o);return{type:"fillSketch",ops:this.renderLines(n,o)}}renderLines(e,o){const n=[];for(const t of e)n.push(...this.helper.doubleLineOps(t[0][0],t[0][1],t[1][0],t[1][1],o));return n}}function Te(r){const e=r[0],o=r[1];return Math.sqrt(Math.pow(e[0]-o[0],2)+Math.pow(e[1]-o[1],2))}class Ot extends He{fillPolygons(e,o){let n=o.hachureGap;n<0&&(n=4*o.strokeWidth),n=Math.max(n,.1);const t=be(e,Object.assign({},o,{hachureGap:n})),s=Math.PI/180*o.hachureAngle,a=[],i=.5*n*Math.cos(s),u=.5*n*Math.sin(s);for(const[c,l]of t)Te([c,l])&&a.push([[c[0]-i,c[1]+u],[...l]],[[c[0]+i,c[1]-u],[...l]]);return{type:"fillSketch",ops:this.renderLines(a,o)}}}class _t extends He{fillPolygons(e,o){const n=this._fillPolygons(e,o),t=Object.assign({},o,{hachureAngle:o.hachureAngle+90}),s=this._fillPolygons(e,t);return n.ops=n.ops.concat(s.ops),n}}class zt{constructor(e){this.helper=e}fillPolygons(e,o){const n=be(e,o=Object.assign({},o,{hachureAngle:0}));return this.dotsOnLines(n,o)}dotsOnLines(e,o){const n=[];let t=o.hachureGap;t<0&&(t=4*o.strokeWidth),t=Math.max(t,.1);let s=o.fillWeight;s<0&&(s=o.strokeWidth/2);const a=t/4;for(const i of e){const u=Te(i),c=u/t,l=Math.ceil(c)-1,p=u-l*t,h=(i[0][0]+i[1][0])/2-t/4,d=Math.min(i[0][1],i[1][1]);for(let f=0;f<l;f++){const g=d+p+f*t,w=h-a+2*Math.random()*a,S=g-a+2*Math.random()*a,v=this.helper.ellipse(w,S,s,s,o);n.push(...v.ops)}}return{type:"fillSketch",ops:n}}}class Bt{constructor(e){this.helper=e}fillPolygons(e,o){const n=be(e,o);return{type:"fillSketch",ops:this.dashedLine(n,o)}}dashedLine(e,o){const n=o.dashOffset<0?o.hachureGap<0?4*o.strokeWidth:o.hachureGap:o.dashOffset,t=o.dashGap<0?o.hachureGap<0?4*o.strokeWidth:o.hachureGap:o.dashGap,s=[];return e.forEach(a=>{const i=Te(a),u=Math.floor(i/(n+t)),c=(i+t-u*(n+t))/2;let l=a[0],p=a[1];l[0]>p[0]&&(l=a[1],p=a[0]);const h=Math.atan((p[1]-l[1])/(p[0]-l[0]));for(let d=0;d<u;d++){const f=d*(n+t),g=f+n,w=[l[0]+f*Math.cos(h)+c*Math.cos(h),l[1]+f*Math.sin(h)+c*Math.sin(h)],S=[l[0]+g*Math.cos(h)+c*Math.cos(h),l[1]+g*Math.sin(h)+c*Math.sin(h)];s.push(...this.helper.doubleLineOps(w[0],w[1],S[0],S[1],o))}}),s}}class Rt{constructor(e){this.helper=e}fillPolygons(e,o){const n=o.hachureGap<0?4*o.strokeWidth:o.hachureGap,t=o.zigzagOffset<0?n:o.zigzagOffset,s=be(e,o=Object.assign({},o,{hachureGap:n+t}));return{type:"fillSketch",ops:this.zigzagLines(s,t,o)}}zigzagLines(e,o,n){const t=[];return e.forEach(s=>{const a=Te(s),i=Math.round(a/(2*o));let u=s[0],c=s[1];u[0]>c[0]&&(u=s[1],c=s[0]);const l=Math.atan((c[1]-u[1])/(c[0]-u[0]));for(let p=0;p<i;p++){const h=2*p*o,d=2*(p+1)*o,f=Math.sqrt(2*Math.pow(o,2)),g=[u[0]+h*Math.cos(l),u[1]+h*Math.sin(l)],w=[u[0]+d*Math.cos(l),u[1]+d*Math.sin(l)],S=[g[0]+f*Math.cos(l+Math.PI/4),g[1]+f*Math.sin(l+Math.PI/4)];t.push(...this.helper.doubleLineOps(g[0],g[1],S[0],S[1],n),...this.helper.doubleLineOps(S[0],S[1],w[0],w[1],n))}}),t}}const Y={};class jt{constructor(e){this.seed=e}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const Dt=0,Oe=1,Ve=2,Se={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function _e(r,e){return r.type===e}function Fe(r){const e=[],o=function(a){const i=new Array;for(;a!=="";)if(a.match(/^([ \t\r\n,]+)/))a=a.substr(RegExp.$1.length);else if(a.match(/^([aAcChHlLmMqQsStTvVzZ])/))i[i.length]={type:Dt,text:RegExp.$1},a=a.substr(RegExp.$1.length);else{if(!a.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];i[i.length]={type:Oe,text:`${parseFloat(RegExp.$1)}`},a=a.substr(RegExp.$1.length)}return i[i.length]={type:Ve,text:""},i}(r);let n="BOD",t=0,s=o[t];for(;!_e(s,Ve);){let a=0;const i=[];if(n==="BOD"){if(s.text!=="M"&&s.text!=="m")return Fe("M0,0"+r);t++,a=Se[s.text],n=s.text}else _e(s,Oe)?a=Se[n]:(t++,a=Se[s.text],n=s.text);if(!(t+a<o.length))throw new Error("Path data ended short");for(let u=t;u<t+a;u++){const c=o[u];if(!_e(c,Oe))throw new Error("Param not a number: "+n+","+c.text);i[i.length]=+c.text}if(typeof Se[n]!="number")throw new Error("Bad segment: "+n);{const u={key:n,data:i};e.push(u),t+=a,s=o[t],n==="M"&&(n="L"),n==="m"&&(n="l")}}return e}function Qe(r){let e=0,o=0,n=0,t=0;const s=[];for(const{key:a,data:i}of r)switch(a){case"M":s.push({key:"M",data:[...i]}),[e,o]=i,[n,t]=i;break;case"m":e+=i[0],o+=i[1],s.push({key:"M",data:[e,o]}),n=e,t=o;break;case"L":s.push({key:"L",data:[...i]}),[e,o]=i;break;case"l":e+=i[0],o+=i[1],s.push({key:"L",data:[e,o]});break;case"C":s.push({key:"C",data:[...i]}),e=i[4],o=i[5];break;case"c":{const u=i.map((c,l)=>l%2?c+o:c+e);s.push({key:"C",data:u}),e=u[4],o=u[5];break}case"Q":s.push({key:"Q",data:[...i]}),e=i[2],o=i[3];break;case"q":{const u=i.map((c,l)=>l%2?c+o:c+e);s.push({key:"Q",data:u}),e=u[2],o=u[3];break}case"A":s.push({key:"A",data:[...i]}),e=i[5],o=i[6];break;case"a":e+=i[5],o+=i[6],s.push({key:"A",data:[i[0],i[1],i[2],i[3],i[4],e,o]});break;case"H":s.push({key:"H",data:[...i]}),e=i[0];break;case"h":e+=i[0],s.push({key:"H",data:[e]});break;case"V":s.push({key:"V",data:[...i]}),o=i[0];break;case"v":o+=i[0],s.push({key:"V",data:[o]});break;case"S":s.push({key:"S",data:[...i]}),e=i[2],o=i[3];break;case"s":{const u=i.map((c,l)=>l%2?c+o:c+e);s.push({key:"S",data:u}),e=u[2],o=u[3];break}case"T":s.push({key:"T",data:[...i]}),e=i[0],o=i[1];break;case"t":e+=i[0],o+=i[1],s.push({key:"T",data:[e,o]});break;case"Z":case"z":s.push({key:"Z",data:[]}),e=n,o=t}return s}function et(r){const e=[];let o="",n=0,t=0,s=0,a=0,i=0,u=0;for(const{key:c,data:l}of r){switch(c){case"M":e.push({key:"M",data:[...l]}),[n,t]=l,[s,a]=l;break;case"C":e.push({key:"C",data:[...l]}),n=l[4],t=l[5],i=l[2],u=l[3];break;case"L":e.push({key:"L",data:[...l]}),[n,t]=l;break;case"H":n=l[0],e.push({key:"L",data:[n,t]});break;case"V":t=l[0],e.push({key:"L",data:[n,t]});break;case"S":{let p=0,h=0;o==="C"||o==="S"?(p=n+(n-i),h=t+(t-u)):(p=n,h=t),e.push({key:"C",data:[p,h,...l]}),i=l[0],u=l[1],n=l[2],t=l[3];break}case"T":{const[p,h]=l;let d=0,f=0;o==="Q"||o==="T"?(d=n+(n-i),f=t+(t-u)):(d=n,f=t);const g=n+2*(d-n)/3,w=t+2*(f-t)/3,S=p+2*(d-p)/3,v=h+2*(f-h)/3;e.push({key:"C",data:[g,w,S,v,p,h]}),i=d,u=f,n=p,t=h;break}case"Q":{const[p,h,d,f]=l,g=n+2*(p-n)/3,w=t+2*(h-t)/3,S=d+2*(p-d)/3,v=f+2*(h-f)/3;e.push({key:"C",data:[g,w,S,v,d,f]}),i=p,u=h,n=d,t=f;break}case"A":{const p=Math.abs(l[0]),h=Math.abs(l[1]),d=l[2],f=l[3],g=l[4],w=l[5],S=l[6];p===0||h===0?(e.push({key:"C",data:[n,t,w,S,w,S]}),n=w,t=S):(n!==w||t!==S)&&(tt(n,t,w,S,p,h,d,f,g).forEach(function(v){e.push({key:"C",data:v})}),n=w,t=S);break}case"Z":e.push({key:"Z",data:[]}),n=s,t=a}o=c}return e}function fe(r,e,o){return[r*Math.cos(o)-e*Math.sin(o),r*Math.sin(o)+e*Math.cos(o)]}function tt(r,e,o,n,t,s,a,i,u,c){const l=(p=a,Math.PI*p/180);var p;let h=[],d=0,f=0,g=0,w=0;if(c)[d,f,g,w]=c;else{[r,e]=fe(r,e,-l),[o,n]=fe(o,n,-l);const P=(r-o)/2,_=(e-n)/2;let R=P*P/(t*t)+_*_/(s*s);R>1&&(R=Math.sqrt(R),t*=R,s*=R);const H=t*t,F=s*s,Z=H*F-H*_*_-F*P*P,ee=H*_*_+F*P*P,D=(i===u?-1:1)*Math.sqrt(Math.abs(Z/ee));g=D*t*_/s+(r+o)/2,w=D*-s*P/t+(e+n)/2,d=Math.asin(parseFloat(((e-w)/s).toFixed(9))),f=Math.asin(parseFloat(((n-w)/s).toFixed(9))),r<g&&(d=Math.PI-d),o<g&&(f=Math.PI-f),d<0&&(d=2*Math.PI+d),f<0&&(f=2*Math.PI+f),u&&d>f&&(d-=2*Math.PI),!u&&f>d&&(f-=2*Math.PI)}let S=f-d;if(Math.abs(S)>120*Math.PI/180){const P=f,_=o,R=n;f=u&&f>d?d+120*Math.PI/180*1:d+120*Math.PI/180*-1,h=tt(o=g+t*Math.cos(f),n=w+s*Math.sin(f),_,R,t,s,a,0,u,[f,P,g,w])}S=f-d;const v=Math.cos(d),A=Math.sin(d),O=Math.cos(f),k=Math.sin(f),b=Math.tan(S/4),E=4/3*t*b,M=4/3*s*b,L=[r,e],B=[r+E*A,e-M*v],N=[o+E*k,n-M*O],T=[o,n];if(B[0]=2*L[0]-B[0],B[1]=2*L[1]-B[1],c)return[B,N,T].concat(h);{h=[B,N,T].concat(h);const P=[];for(let _=0;_<h.length;_+=3){const R=fe(h[_][0],h[_][1],l),H=fe(h[_+1][0],h[_+1][1],l),F=fe(h[_+2][0],h[_+2][1],l);P.push([R[0],R[1],H[0],H[1],F[0],F[1]])}return P}}const Ht={randOffset:function(r,e){return q(r,e)},randOffsetWithRange:function(r,e,o){return Ce(r,e,o)},ellipse:function(r,e,o,n,t){const s=ot(o,n,t);return Re(r,e,t,s).opset},doubleLineOps:function(r,e,o,n,t){return oe(r,e,o,n,t,!0)}};function nt(r,e,o,n,t){return{type:"path",ops:oe(r,e,o,n,t)}}function Ee(r,e,o){const n=(r||[]).length;if(n>2){const t=[];for(let s=0;s<n-1;s++)t.push(...oe(r[s][0],r[s][1],r[s+1][0],r[s+1][1],o));return e&&t.push(...oe(r[n-1][0],r[n-1][1],r[0][0],r[0][1],o)),{type:"path",ops:t}}return n===2?nt(r[0][0],r[0][1],r[1][0],r[1][1],o):{type:"path",ops:[]}}function Ft(r,e,o,n,t){return function(s,a){return Ee(s,!0,a)}([[r,e],[r+o,e],[r+o,e+n],[r,e+n]],t)}function Je(r,e){if(r.length){const o=typeof r[0][0]=="number"?[r]:r,n=ve(o[0],1*(1+.2*e.roughness),e),t=e.disableMultiStroke?[]:ve(o[0],1.5*(1+.22*e.roughness),Ge(e));for(let s=1;s<o.length;s++){const a=o[s];if(a.length){const i=ve(a,1*(1+.2*e.roughness),e),u=e.disableMultiStroke?[]:ve(a,1.5*(1+.22*e.roughness),Ge(e));for(const c of i)c.op!=="move"&&n.push(c);for(const c of u)c.op!=="move"&&t.push(c)}}return{type:"path",ops:n.concat(t)}}return{type:"path",ops:[]}}function ot(r,e,o){const n=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(r/2,2)+Math.pow(e/2,2))/2)),t=Math.ceil(Math.max(o.curveStepCount,o.curveStepCount/Math.sqrt(200)*n)),s=2*Math.PI/t;let a=Math.abs(r/2),i=Math.abs(e/2);const u=1-o.curveFitting;return a+=q(a*u,o),i+=q(i*u,o),{increment:s,rx:a,ry:i}}function Re(r,e,o,n){const[t,s]=Ye(n.increment,r,e,n.rx,n.ry,1,n.increment*Ce(.1,Ce(.4,1,o),o),o);let a=Me(t,null,o);if(!o.disableMultiStroke&&o.roughness!==0){const[i]=Ye(n.increment,r,e,n.rx,n.ry,1.5,0,o),u=Me(i,null,o);a=a.concat(u)}return{estimatedPoints:s,opset:{type:"path",ops:a}}}function Ze(r,e,o,n,t,s,a,i,u){const c=r,l=e;let p=Math.abs(o/2),h=Math.abs(n/2);p+=q(.01*p,u),h+=q(.01*h,u);let d=t,f=s;for(;d<0;)d+=2*Math.PI,f+=2*Math.PI;f-d>2*Math.PI&&(d=0,f=2*Math.PI);const g=2*Math.PI/u.curveStepCount,w=Math.min(g/2,(f-d)/2),S=Ke(w,c,l,p,h,d,f,1,u);if(!u.disableMultiStroke){const v=Ke(w,c,l,p,h,d,f,1.5,u);S.push(...v)}return a&&(i?S.push(...oe(c,l,c+p*Math.cos(d),l+h*Math.sin(d),u),...oe(c,l,c+p*Math.cos(f),l+h*Math.sin(f),u)):S.push({op:"lineTo",data:[c,l]},{op:"lineTo",data:[c+p*Math.cos(d),l+h*Math.sin(d)]})),{type:"path",ops:S}}function Ue(r,e){const o=et(Qe(Fe(r))),n=[];let t=[0,0],s=[0,0];for(const{key:a,data:i}of o)switch(a){case"M":s=[i[0],i[1]],t=[i[0],i[1]];break;case"L":n.push(...oe(s[0],s[1],i[0],i[1],e)),s=[i[0],i[1]];break;case"C":{const[u,c,l,p,h,d]=i;n.push(...Wt(u,c,l,p,h,d,s,e)),s=[h,d];break}case"Z":n.push(...oe(s[0],s[1],t[0],t[1],e)),s=[t[0],t[1]]}return{type:"path",ops:n}}function ze(r,e){const o=[];for(const n of r)if(n.length){const t=e.maxRandomnessOffset||0,s=n.length;if(s>2){o.push({op:"move",data:[n[0][0]+q(t,e),n[0][1]+q(t,e)]});for(let a=1;a<s;a++)o.push({op:"lineTo",data:[n[a][0]+q(t,e),n[a][1]+q(t,e)]})}}return{type:"fillPath",ops:o}}function ie(r,e){return function(o,n){let t=o.fillStyle||"hachure";if(!Y[t])switch(t){case"zigzag":Y[t]||(Y[t]=new Ot(n));break;case"cross-hatch":Y[t]||(Y[t]=new _t(n));break;case"dots":Y[t]||(Y[t]=new zt(n));break;case"dashed":Y[t]||(Y[t]=new Bt(n));break;case"zigzag-line":Y[t]||(Y[t]=new Rt(n));break;default:t="hachure",Y[t]||(Y[t]=new He(n))}return Y[t]}(e,Ht).fillPolygons(r,e)}function Ge(r){const e=Object.assign({},r);return e.randomizer=void 0,r.seed&&(e.seed=r.seed+1),e}function st(r){return r.randomizer||(r.randomizer=new jt(r.seed||0)),r.randomizer.next()}function Ce(r,e,o,n=1){return o.roughness*n*(st(o)*(e-r)+r)}function q(r,e,o=1){return Ce(-r,r,e,o)}function oe(r,e,o,n,t,s=!1){const a=s?t.disableMultiStrokeFill:t.disableMultiStroke,i=je(r,e,o,n,t,!0,!1);if(a)return i;const u=je(r,e,o,n,t,!0,!0);return i.concat(u)}function je(r,e,o,n,t,s,a){const i=Math.pow(r-o,2)+Math.pow(e-n,2),u=Math.sqrt(i);let c=1;c=u<200?1:u>500?.4:-.0016668*u+1.233334;let l=t.maxRandomnessOffset||0;l*l*100>i&&(l=u/10);const p=l/2,h=.2+.2*st(t);let d=t.bowing*t.maxRandomnessOffset*(n-e)/200,f=t.bowing*t.maxRandomnessOffset*(r-o)/200;d=q(d,t,c),f=q(f,t,c);const g=[],w=()=>q(p,t,c),S=()=>q(l,t,c),v=t.preserveVertices;return a?g.push({op:"move",data:[r+(v?0:w()),e+(v?0:w())]}):g.push({op:"move",data:[r+(v?0:q(l,t,c)),e+(v?0:q(l,t,c))]}),a?g.push({op:"bcurveTo",data:[d+r+(o-r)*h+w(),f+e+(n-e)*h+w(),d+r+2*(o-r)*h+w(),f+e+2*(n-e)*h+w(),o+(v?0:w()),n+(v?0:w())]}):g.push({op:"bcurveTo",data:[d+r+(o-r)*h+S(),f+e+(n-e)*h+S(),d+r+2*(o-r)*h+S(),f+e+2*(n-e)*h+S(),o+(v?0:S()),n+(v?0:S())]}),g}function ve(r,e,o){if(!r.length)return[];const n=[];n.push([r[0][0]+q(e,o),r[0][1]+q(e,o)]),n.push([r[0][0]+q(e,o),r[0][1]+q(e,o)]);for(let t=1;t<r.length;t++)n.push([r[t][0]+q(e,o),r[t][1]+q(e,o)]),t===r.length-1&&n.push([r[t][0]+q(e,o),r[t][1]+q(e,o)]);return Me(n,null,o)}function Me(r,e,o){const n=r.length,t=[];if(n>3){const s=[],a=1-o.curveTightness;t.push({op:"move",data:[r[1][0],r[1][1]]});for(let i=1;i+2<n;i++){const u=r[i];s[0]=[u[0],u[1]],s[1]=[u[0]+(a*r[i+1][0]-a*r[i-1][0])/6,u[1]+(a*r[i+1][1]-a*r[i-1][1])/6],s[2]=[r[i+1][0]+(a*r[i][0]-a*r[i+2][0])/6,r[i+1][1]+(a*r[i][1]-a*r[i+2][1])/6],s[3]=[r[i+1][0],r[i+1][1]],t.push({op:"bcurveTo",data:[s[1][0],s[1][1],s[2][0],s[2][1],s[3][0],s[3][1]]})}}else n===3?(t.push({op:"move",data:[r[1][0],r[1][1]]}),t.push({op:"bcurveTo",data:[r[1][0],r[1][1],r[2][0],r[2][1],r[2][0],r[2][1]]})):n===2&&t.push(...je(r[0][0],r[0][1],r[1][0],r[1][1],o,!0,!0));return t}function Ye(r,e,o,n,t,s,a,i){const u=[],c=[];if(i.roughness===0){r/=4,c.push([e+n*Math.cos(-r),o+t*Math.sin(-r)]);for(let l=0;l<=2*Math.PI;l+=r){const p=[e+n*Math.cos(l),o+t*Math.sin(l)];u.push(p),c.push(p)}c.push([e+n*Math.cos(0),o+t*Math.sin(0)]),c.push([e+n*Math.cos(r),o+t*Math.sin(r)])}else{const l=q(.5,i)-Math.PI/2;c.push([q(s,i)+e+.9*n*Math.cos(l-r),q(s,i)+o+.9*t*Math.sin(l-r)]);const p=2*Math.PI+l-.01;for(let h=l;h<p;h+=r){const d=[q(s,i)+e+n*Math.cos(h),q(s,i)+o+t*Math.sin(h)];u.push(d),c.push(d)}c.push([q(s,i)+e+n*Math.cos(l+2*Math.PI+.5*a),q(s,i)+o+t*Math.sin(l+2*Math.PI+.5*a)]),c.push([q(s,i)+e+.98*n*Math.cos(l+a),q(s,i)+o+.98*t*Math.sin(l+a)]),c.push([q(s,i)+e+.9*n*Math.cos(l+.5*a),q(s,i)+o+.9*t*Math.sin(l+.5*a)])}return[c,u]}function Ke(r,e,o,n,t,s,a,i,u){const c=s+q(.1,u),l=[];l.push([q(i,u)+e+.9*n*Math.cos(c-r),q(i,u)+o+.9*t*Math.sin(c-r)]);for(let p=c;p<=a;p+=r)l.push([q(i,u)+e+n*Math.cos(p),q(i,u)+o+t*Math.sin(p)]);return l.push([e+n*Math.cos(a),o+t*Math.sin(a)]),l.push([e+n*Math.cos(a),o+t*Math.sin(a)]),Me(l,null,u)}function Wt(r,e,o,n,t,s,a,i){const u=[],c=[i.maxRandomnessOffset||1,(i.maxRandomnessOffset||1)+.3];let l=[0,0];const p=i.disableMultiStroke?1:2,h=i.preserveVertices;for(let d=0;d<p;d++)d===0?u.push({op:"move",data:[a[0],a[1]]}):u.push({op:"move",data:[a[0]+(h?0:q(c[0],i)),a[1]+(h?0:q(c[0],i))]}),l=h?[t,s]:[t+q(c[d],i),s+q(c[d],i)],u.push({op:"bcurveTo",data:[r+q(c[d],i),e+q(c[d],i),o+q(c[d],i),n+q(c[d],i),l[0],l[1]]});return u}function me(r){return[...r]}function Xe(r,e=0){const o=r.length;if(o<3)throw new Error("A curve must have at least three points.");const n=[];if(o===3)n.push(me(r[0]),me(r[1]),me(r[2]),me(r[2]));else{const t=[];t.push(r[0],r[0]);for(let i=1;i<r.length;i++)t.push(r[i]),i===r.length-1&&t.push(r[i]);const s=[],a=1-e;n.push(me(t[0]));for(let i=1;i+2<t.length;i++){const u=t[i];s[0]=[u[0],u[1]],s[1]=[u[0]+(a*t[i+1][0]-a*t[i-1][0])/6,u[1]+(a*t[i+1][1]-a*t[i-1][1])/6],s[2]=[t[i+1][0]+(a*t[i][0]-a*t[i+2][0])/6,t[i+1][1]+(a*t[i][1]-a*t[i+2][1])/6],s[3]=[t[i+1][0],t[i+1][1]],n.push(s[1],s[2],s[3])}}return n}function ke(r,e){return Math.pow(r[0]-e[0],2)+Math.pow(r[1]-e[1],2)}function Vt(r,e,o){const n=ke(e,o);if(n===0)return ke(r,e);let t=((r[0]-e[0])*(o[0]-e[0])+(r[1]-e[1])*(o[1]-e[1]))/n;return t=Math.max(0,Math.min(1,t)),ke(r,re(e,o,t))}function re(r,e,o){return[r[0]+(e[0]-r[0])*o,r[1]+(e[1]-r[1])*o]}function De(r,e,o,n){const t=n||[];if(function(i,u){const c=i[u+0],l=i[u+1],p=i[u+2],h=i[u+3];let d=3*l[0]-2*c[0]-h[0];d*=d;let f=3*l[1]-2*c[1]-h[1];f*=f;let g=3*p[0]-2*h[0]-c[0];g*=g;let w=3*p[1]-2*h[1]-c[1];return w*=w,d<g&&(d=g),f<w&&(f=w),d+f}(r,e)<o){const i=r[e+0];t.length?(s=t[t.length-1],a=i,Math.sqrt(ke(s,a))>1&&t.push(i)):t.push(i),t.push(r[e+3])}else{const u=r[e+0],c=r[e+1],l=r[e+2],p=r[e+3],h=re(u,c,.5),d=re(c,l,.5),f=re(l,p,.5),g=re(h,d,.5),w=re(d,f,.5),S=re(g,w,.5);De([u,h,g,S],0,o,t),De([S,w,f,p],0,o,t)}var s,a;return t}function Jt(r,e){return Le(r,0,r.length,e)}function Le(r,e,o,n,t){const s=t||[],a=r[e],i=r[o-1];let u=0,c=1;for(let l=e+1;l<o-1;++l){const p=Vt(r[l],a,i);p>u&&(u=p,c=l)}return Math.sqrt(u)>n?(Le(r,e,c+1,n,s),Le(r,c,o,n,s)):(s.length||s.push(a),s.push(i)),s}function Be(r,e=.15,o){const n=[],t=(r.length-1)/3;for(let s=0;s<t;s++)De(r,3*s,e,n);return o&&o>0?Le(n,0,n.length,o):n}const X="none";class Ae{constructor(e){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=e||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(e){return e?Object.assign({},this.defaultOptions,e):this.defaultOptions}_d(e,o,n){return{shape:e,sets:o||[],options:n||this.defaultOptions}}line(e,o,n,t,s){const a=this._o(s);return this._d("line",[nt(e,o,n,t,a)],a)}rectangle(e,o,n,t,s){const a=this._o(s),i=[],u=Ft(e,o,n,t,a);if(a.fill){const c=[[e,o],[e+n,o],[e+n,o+t],[e,o+t]];a.fillStyle==="solid"?i.push(ze([c],a)):i.push(ie([c],a))}return a.stroke!==X&&i.push(u),this._d("rectangle",i,a)}ellipse(e,o,n,t,s){const a=this._o(s),i=[],u=ot(n,t,a),c=Re(e,o,a,u);if(a.fill)if(a.fillStyle==="solid"){const l=Re(e,o,a,u).opset;l.type="fillPath",i.push(l)}else i.push(ie([c.estimatedPoints],a));return a.stroke!==X&&i.push(c.opset),this._d("ellipse",i,a)}circle(e,o,n,t){const s=this.ellipse(e,o,n,n,t);return s.shape="circle",s}linearPath(e,o){const n=this._o(o);return this._d("linearPath",[Ee(e,!1,n)],n)}arc(e,o,n,t,s,a,i=!1,u){const c=this._o(u),l=[],p=Ze(e,o,n,t,s,a,i,!0,c);if(i&&c.fill)if(c.fillStyle==="solid"){const h=Object.assign({},c);h.disableMultiStroke=!0;const d=Ze(e,o,n,t,s,a,!0,!1,h);d.type="fillPath",l.push(d)}else l.push(function(h,d,f,g,w,S,v){const A=h,O=d;let k=Math.abs(f/2),b=Math.abs(g/2);k+=q(.01*k,v),b+=q(.01*b,v);let E=w,M=S;for(;E<0;)E+=2*Math.PI,M+=2*Math.PI;M-E>2*Math.PI&&(E=0,M=2*Math.PI);const L=(M-E)/v.curveStepCount,B=[];for(let N=E;N<=M;N+=L)B.push([A+k*Math.cos(N),O+b*Math.sin(N)]);return B.push([A+k*Math.cos(M),O+b*Math.sin(M)]),B.push([A,O]),ie([B],v)}(e,o,n,t,s,a,c));return c.stroke!==X&&l.push(p),this._d("arc",l,c)}curve(e,o){const n=this._o(o),t=[],s=Je(e,n);if(n.fill&&n.fill!==X)if(n.fillStyle==="solid"){const a=Je(e,Object.assign(Object.assign({},n),{disableMultiStroke:!0,roughness:n.roughness?n.roughness+n.fillShapeRoughnessGain:0}));t.push({type:"fillPath",ops:this._mergedShape(a.ops)})}else{const a=[],i=e;if(i.length){const u=typeof i[0][0]=="number"?[i]:i;for(const c of u)c.length<3?a.push(...c):c.length===3?a.push(...Be(Xe([c[0],c[0],c[1],c[2]]),10,(1+n.roughness)/2)):a.push(...Be(Xe(c),10,(1+n.roughness)/2))}a.length&&t.push(ie([a],n))}return n.stroke!==X&&t.push(s),this._d("curve",t,n)}polygon(e,o){const n=this._o(o),t=[],s=Ee(e,!0,n);return n.fill&&(n.fillStyle==="solid"?t.push(ze([e],n)):t.push(ie([e],n))),n.stroke!==X&&t.push(s),this._d("polygon",t,n)}path(e,o){const n=this._o(o),t=[];if(!e)return this._d("path",t,n);e=(e||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const s=n.fill&&n.fill!=="transparent"&&n.fill!==X,a=n.stroke!==X,i=!!(n.simplification&&n.simplification<1),u=function(l,p,h){const d=et(Qe(Fe(l))),f=[];let g=[],w=[0,0],S=[];const v=()=>{S.length>=4&&g.push(...Be(S,p)),S=[]},A=()=>{v(),g.length&&(f.push(g),g=[])};for(const{key:k,data:b}of d)switch(k){case"M":A(),w=[b[0],b[1]],g.push(w);break;case"L":v(),g.push([b[0],b[1]]);break;case"C":if(!S.length){const E=g.length?g[g.length-1]:w;S.push([E[0],E[1]])}S.push([b[0],b[1]]),S.push([b[2],b[3]]),S.push([b[4],b[5]]);break;case"Z":v(),g.push([w[0],w[1]])}if(A(),!h)return f;const O=[];for(const k of f){const b=Jt(k,h);b.length&&O.push(b)}return O}(e,1,i?4-4*(n.simplification||1):(1+n.roughness)/2),c=Ue(e,n);if(s)if(n.fillStyle==="solid")if(u.length===1){const l=Ue(e,Object.assign(Object.assign({},n),{disableMultiStroke:!0,roughness:n.roughness?n.roughness+n.fillShapeRoughnessGain:0}));t.push({type:"fillPath",ops:this._mergedShape(l.ops)})}else t.push(ze(u,n));else t.push(ie(u,n));return a&&(i?u.forEach(l=>{t.push(Ee(l,!1,n))}):t.push(c)),this._d("path",t,n)}opsToPath(e,o){let n="";for(const t of e.ops){const s=typeof o=="number"&&o>=0?t.data.map(a=>+a.toFixed(o)):t.data;switch(t.op){case"move":n+=`M${s[0]} ${s[1]} `;break;case"bcurveTo":n+=`C${s[0]} ${s[1]}, ${s[2]} ${s[3]}, ${s[4]} ${s[5]} `;break;case"lineTo":n+=`L${s[0]} ${s[1]} `}}return n.trim()}toPaths(e){const o=e.sets||[],n=e.options||this.defaultOptions,t=[];for(const s of o){let a=null;switch(s.type){case"path":a={d:this.opsToPath(s),stroke:n.stroke,strokeWidth:n.strokeWidth,fill:X};break;case"fillPath":a={d:this.opsToPath(s),stroke:X,strokeWidth:0,fill:n.fill||X};break;case"fillSketch":a=this.fillSketch(s,n)}a&&t.push(a)}return t}fillSketch(e,o){let n=o.fillWeight;return n<0&&(n=o.strokeWidth/2),{d:this.opsToPath(e),stroke:o.fill||X,strokeWidth:n,fill:X}}_mergedShape(e){return e.filter((o,n)=>n===0||o.op!=="move")}}class Zt{constructor(e,o){this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.gen=new Ae(o)}draw(e){const o=e.sets||[],n=e.options||this.getDefaultOptions(),t=this.ctx,s=e.options.fixedDecimalPlaceDigits;for(const a of o)switch(a.type){case"path":t.save(),t.strokeStyle=n.stroke==="none"?"transparent":n.stroke,t.lineWidth=n.strokeWidth,n.strokeLineDash&&t.setLineDash(n.strokeLineDash),n.strokeLineDashOffset&&(t.lineDashOffset=n.strokeLineDashOffset),this._drawToContext(t,a,s),t.restore();break;case"fillPath":{t.save(),t.fillStyle=n.fill||"";const i=e.shape==="curve"||e.shape==="polygon"||e.shape==="path"?"evenodd":"nonzero";this._drawToContext(t,a,s,i),t.restore();break}case"fillSketch":this.fillSketch(t,a,n)}}fillSketch(e,o,n){let t=n.fillWeight;t<0&&(t=n.strokeWidth/2),e.save(),n.fillLineDash&&e.setLineDash(n.fillLineDash),n.fillLineDashOffset&&(e.lineDashOffset=n.fillLineDashOffset),e.strokeStyle=n.fill||"",e.lineWidth=t,this._drawToContext(e,o,n.fixedDecimalPlaceDigits),e.restore()}_drawToContext(e,o,n,t="nonzero"){e.beginPath();for(const s of o.ops){const a=typeof n=="number"&&n>=0?s.data.map(i=>+i.toFixed(n)):s.data;switch(s.op){case"move":e.moveTo(a[0],a[1]);break;case"bcurveTo":e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"lineTo":e.lineTo(a[0],a[1])}}o.type==="fillPath"?e.fill(t):e.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(e,o,n,t,s){const a=this.gen.line(e,o,n,t,s);return this.draw(a),a}rectangle(e,o,n,t,s){const a=this.gen.rectangle(e,o,n,t,s);return this.draw(a),a}ellipse(e,o,n,t,s){const a=this.gen.ellipse(e,o,n,t,s);return this.draw(a),a}circle(e,o,n,t){const s=this.gen.circle(e,o,n,t);return this.draw(s),s}linearPath(e,o){const n=this.gen.linearPath(e,o);return this.draw(n),n}polygon(e,o){const n=this.gen.polygon(e,o);return this.draw(n),n}arc(e,o,n,t,s,a,i=!1,u){const c=this.gen.arc(e,o,n,t,s,a,i,u);return this.draw(c),c}curve(e,o){const n=this.gen.curve(e,o);return this.draw(n),n}path(e,o){const n=this.gen.path(e,o);return this.draw(n),n}}const xe="http://www.w3.org/2000/svg";class Ut{constructor(e,o){this.svg=e,this.gen=new Ae(o)}draw(e){const o=e.sets||[],n=e.options||this.getDefaultOptions(),t=this.svg.ownerDocument||window.document,s=t.createElementNS(xe,"g"),a=e.options.fixedDecimalPlaceDigits;for(const i of o){let u=null;switch(i.type){case"path":u=t.createElementNS(xe,"path"),u.setAttribute("d",this.opsToPath(i,a)),u.setAttribute("stroke",n.stroke),u.setAttribute("stroke-width",n.strokeWidth+""),u.setAttribute("fill","none"),n.strokeLineDash&&u.setAttribute("stroke-dasharray",n.strokeLineDash.join(" ").trim()),n.strokeLineDashOffset&&u.setAttribute("stroke-dashoffset",`${n.strokeLineDashOffset}`);break;case"fillPath":u=t.createElementNS(xe,"path"),u.setAttribute("d",this.opsToPath(i,a)),u.setAttribute("stroke","none"),u.setAttribute("stroke-width","0"),u.setAttribute("fill",n.fill||""),e.shape!=="curve"&&e.shape!=="polygon"||u.setAttribute("fill-rule","evenodd");break;case"fillSketch":u=this.fillSketch(t,i,n)}u&&s.appendChild(u)}return s}fillSketch(e,o,n){let t=n.fillWeight;t<0&&(t=n.strokeWidth/2);const s=e.createElementNS(xe,"path");return s.setAttribute("d",this.opsToPath(o,n.fixedDecimalPlaceDigits)),s.setAttribute("stroke",n.fill||""),s.setAttribute("stroke-width",t+""),s.setAttribute("fill","none"),n.fillLineDash&&s.setAttribute("stroke-dasharray",n.fillLineDash.join(" ").trim()),n.fillLineDashOffset&&s.setAttribute("stroke-dashoffset",`${n.fillLineDashOffset}`),s}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(e,o){return this.gen.opsToPath(e,o)}line(e,o,n,t,s){const a=this.gen.line(e,o,n,t,s);return this.draw(a)}rectangle(e,o,n,t,s){const a=this.gen.rectangle(e,o,n,t,s);return this.draw(a)}ellipse(e,o,n,t,s){const a=this.gen.ellipse(e,o,n,t,s);return this.draw(a)}circle(e,o,n,t){const s=this.gen.circle(e,o,n,t);return this.draw(s)}linearPath(e,o){const n=this.gen.linearPath(e,o);return this.draw(n)}polygon(e,o){const n=this.gen.polygon(e,o);return this.draw(n)}arc(e,o,n,t,s,a,i=!1,u){const c=this.gen.arc(e,o,n,t,s,a,i,u);return this.draw(c)}curve(e,o){const n=this.gen.curve(e,o);return this.draw(n)}path(e,o){const n=this.gen.path(e,o);return this.draw(n)}}var rt={canvas:(r,e)=>new Zt(r,e),svg:(r,e)=>new Ut(r,e),generator:r=>new Ae(r),newSeed:()=>Ae.newSeed()};function Gt(r,e={}){if(!r)return;const o=e.width||800,n=e.height||600;r.innerHTML="";const t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("width",o),t.setAttribute("height",n),t.setAttribute("viewBox",`0 0 ${o} ${n}`),t.setAttribute("xmlns","http://www.w3.org/2000/svg"),r.appendChild(t);const s=rt.svg(t),a={frame:"#222",accent:"#fe8100",text:"#111"};t.appendChild(s.rectangle(10,10,o-20,n-20,{stroke:a.frame,strokeWidth:2,roughness:2.2,bowing:1.5})),t.appendChild(s.rectangle(30,30,o-60,90,{stroke:a.accent,strokeWidth:2.5,fill:"#fff7ec",fillStyle:"hachure",roughness:1.7,bowing:1.2})),t.appendChild(s.rectangle(30,140,180,n-180,{stroke:a.frame,strokeWidth:2,fill:"#f5f5f5",fillStyle:"cross-hatch",roughness:1.5})),t.appendChild(s.rectangle(230,140,o-270,n-180,{stroke:a.frame,strokeWidth:2,roughness:1.6}));for(let c=0;c<6;c++){const l=180+c*45;t.appendChild(s.line(50,l,190,l,{stroke:a.frame,strokeWidth:1.5,roughness:1.8}))}for(let c=0;c<8;c++){const l=200+c*40;t.appendChild(s.line(250,l,o-80,l,{stroke:a.frame,strokeWidth:1.4,roughness:1.9}))}const i=document.createElementNS("http://www.w3.org/2000/svg","text");i.setAttribute("x",50),i.setAttribute("y",85),i.setAttribute("fill",a.text),i.setAttribute("font-size","36"),i.setAttribute("font-family","Arial, Helvetica, sans-serif"),i.textContent=e.title||"Sketched Template",t.appendChild(i);const u=document.createElementNS("http://www.w3.org/2000/svg","text");return u.setAttribute("x",50),u.setAttribute("y",115),u.setAttribute("fill",a.text),u.setAttribute("font-size","18"),u.setAttribute("font-family","Arial, Helvetica, sans-serif"),u.textContent=e.subtitle||"Rough.js example",t.appendChild(u),t}function Yt(r,e={}){if(!r)return;const o=e.width||800,n=e.height||300;r.innerHTML="";const t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("width",o),t.setAttribute("height",n),t.setAttribute("viewBox",`0 0 ${o} ${n}`),t.setAttribute("xmlns","http://www.w3.org/2000/svg"),r.appendChild(t);const s=rt.svg(t),a=n-40,i=60,u=o-220,c=140,l=90;t.appendChild(s.line(20,a,o-20,a,{stroke:"#222",strokeWidth:2,roughness:1.6})),t.appendChild(s.rectangle(20,40,40,a-40,{stroke:"#222",fill:"#f5f5f5",fillStyle:"zigzag",strokeWidth:2,roughness:1.6})),t.appendChild(s.rectangle(u,a-l,c,l,{stroke:"#0d47a1",fill:"#e3f2fd",fillStyle:"hachure",strokeWidth:2.4,roughness:1.4,bowing:1.2}));const p=i+40,h=u-10,d=a-l/2,f=8,g=(h-p)/f;let w=`M ${p} ${d}`;for(let E=0;E<f;E++){const M=p+(E+.5)*g,L=d+(E%2===0?-18:18);w+=` L ${M} ${L}`,w+=` L ${p+(E+1)*g} ${d}`}const S=document.createElementNS("http://www.w3.org/2000/svg","path");S.setAttribute("d",w),S.setAttribute("stroke","#e65100"),S.setAttribute("fill","none"),S.setAttribute("stroke-width","3"),S.setAttribute("stroke-linecap","round"),S.setAttribute("stroke-linejoin","round"),t.appendChild(S);const v=d+50,A=p+20,O=u-20;t.appendChild(s.line(A,v,A+40,v,{stroke:"#444",strokeWidth:2})),t.appendChild(s.rectangle(A+40,v-12,50,24,{stroke:"#444",fill:"#f0f0f0",fillStyle:"solid",strokeWidth:2,roughness:1.2})),t.appendChild(s.line(A+90,v,O-40,v,{stroke:"#444",strokeWidth:2})),t.appendChild(s.rectangle(O-40,v-16,26,32,{stroke:"#444",fill:"none",strokeWidth:2,roughness:1.2})),t.appendChild(s.line(O-14,v-16,O-14,v+16,{stroke:"#444",strokeWidth:2}));const k=(E,M,L,B="#111",N=16)=>{const T=document.createElementNS("http://www.w3.org/2000/svg","text");T.setAttribute("x",M),T.setAttribute("y",L),T.setAttribute("fill",B),T.setAttribute("font-size",N),T.setAttribute("font-family","Arial, Helvetica, sans-serif"),T.textContent=E,t.appendChild(T)};k(e.massLabel||"m",u+c/2-6,a-l/2+6,"#0d47a1",18),k(e.springLabel||"k",(p+h)/2,d-24,"#e65100",16),k(e.damperLabel||"c",(A+O)/2,v+28,"#444",16),k(e.forceLabel||"F(t)",u+c+20,a-l/2,"#b71c1c",16),t.appendChild(s.line(u+c,d,u+c+40,d,{stroke:"#b71c1c",strokeWidth:3,roughness:1.4}));const b=document.createElementNS("http://www.w3.org/2000/svg","path");return b.setAttribute("d",`M ${u+c+40} ${d} L ${u+c+30} ${d-8} L ${u+c+30} ${d+8} Z`),b.setAttribute("fill","#b71c1c"),t.appendChild(b),t}function Kt(r){const e=JXG.JSXGraph.initBoard(r,{boundingbox:[-1,6,10,-1],axis:!0,showCopyright:!1,showNavigation:!1}),o=(c,l)=>2+Math.sin(c+l);let n=0;const t=(c=0)=>(getComputedStyle(document.documentElement).getPropertyValue(`--jxg-color-${c+1}`)||"").trim()||"#e65100",s=e.create("curve",[()=>{const c=[];for(let l=0;l<=100;l++)c.push(l*.1);return c},()=>{const c=[];for(let l=0;l<=100;l++){const p=l*.1;c.push(o(p,n))}return c}],{strokeColor:t(0),strokeWidth:3}),a=()=>{s.setAttribute({strokeColor:t(0)}),e.update()};new MutationObserver(()=>a()).observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]});const u=()=>{n+=.05,s.updateDataArray(),e.update(),requestAnimationFrame(u)};u()}window.addEventListener("DOMContentLoaded",()=>{Pt();const r=document.getElementById("sketch-template-demo");r&&Gt(r,{width:450,height:300,title:"Rough.js Skizze",subtitle:"Anpassbare Vorlage"});const e=document.getElementById("msd-sketch");e&&Yt(e,{width:450,height:180,massLabel:"m",springLabel:"k",damperLabel:"c",forceLabel:"F(t)"}),document.getElementById("jsx-graph-demo")&&Kt("jsx-graph-demo")});
